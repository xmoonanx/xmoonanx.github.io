---
title: "[OS] Operating System(9-3): Main Memory - Swapping"

categories: [CS, Operating System, OS]
tags:
  - [CS, OS, Operating System, Scheduling]
toc: true
toc_sticky: true
use_math: true

date: 2025-05-27
last_modified_at: 2025-05-27
---
>ğŸ€ ìš´ì˜ì²´ì œ ì „ê³µ ìˆ˜ì—… ì •ë¦¬

{:.prompt-warning}
> í”„ë¡œì„¸ìŠ¤ë“¤ì´ ëŒê³ ìˆëŠ”ë° ë¬¼ë¦¬ì ì¸ ë©”ëª¨ë¦¬ê°€ ë¶€ì¡±í•  ë•Œ ì–´ë–»ê²Œ í•´ê²°í•  ìˆ˜ ìˆì„ê¹Œ?
>
ì¦‰, ë©”ëª¨ë¦¬ ë¶€ì¡± ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ ê¸°ë²•ì´ **Swapping**

## Swapping
---
ğŸ“š**<span style="color: #008000">Swapping</span>**: ëŒê³  ìˆëŠ” í”„ë¡œì„¸ìŠ¤ë¥¼ ì¼ì‹œì ìœ¼ë¡œ **backing store(ë³´ì¡° ì €ì¥ì¥ì¹˜)**ë¡œ ë‚´ë³´ë‚´ê³ , í•„ìš”í•  ë•Œ ë‹¤ì‹œ ë©”ëª¨ë¦¬ë¡œ ê°€ì ¸ì˜¤ëŠ” ë°©ì‹

âœ…ëª¨ë“  í”„ë¡œì„¸ìŠ¤ë“¤ì˜ **ë¬¼ë¦¬ì  ë©”ëª¨ë¦¬ ê³µê°„ í•©ê³„ê°€ ì‹¤ì œ ë¬¼ë¦¬ ë©”ëª¨ë¦¬ë¥¼ ì´ˆê³¼í•  ìˆ˜ ìˆê²Œ ë§Œë“œëŠ” ê¸°ìˆ **  

![alt text](../assets/img/OS/swapping.png)
> schematic of Swapping

![alt text](../assets/img/OS/swappingtype.png)
> type of swapping

* Swapping = Standard Swapping

âœ…**Swapping ê³¼ì •**:  
1. **ë©”ëª¨ë¦¬ ë¶€ì¡± ê°ì§€**
2. **í¬ìƒì ì„ íƒ**: Swap outí•  í”„ë¡œì„¸ìŠ¤ ê²°ì •(ë‚®ì€ ìš°ì„ ìˆœìœ„)
3. **Swap out**: í”„ë¡œì„¸ìŠ¤ë¥¼ Backing storeë¡œ ì´ë™
4. **ë©”ëª¨ë¦¬ í• ë‹¹**: ìƒˆë¡œìš´ í”„ë¡œì„¸ìŠ¤ì—ê²Œ ë©”ëª¨ë¦¬ ì œê³µ

* **<span style="color: #008000">Backing Store</span>**: ëª¨ë“  ì‚¬ìš©ìì˜ ë©”ëª¨ë¦¬ ì´ë¯¸ì§€ ì‚¬ë³¸ì„ ìˆ˜ìš©í•  ìˆ˜ ìˆì„ ë§Œí¼ í° fask disk
* **Transfer Time**: Swapping timeì˜ ì£¼ìš” ë¶€ë¶„, ìŠ¤ì™€í•‘ë˜ëŠ” ë©”ëª¨ë¦¬ ì–‘ì— ì •ë¹„ë¡€
* **Direct Access**: Backing storeëŠ” ë©”ëª¨ë¦¬ ì´ë¯¸ì§€ì— ëŒ€í•œ ì§ì ‘ ì ‘ê·¼ì„ ì œê³µí•´ì•¼ í•¨

* **Roll Out, Roll In**: **ìš°ì„ ìˆœìœ„ ê¸°ë°˜ ìŠ¤ì¼€ì¤„ë§ ì•Œê³ ë¦¬ì¦˜**ì—ì„œ ì‚¬ìš©ë˜ëŠ” ìŠ¤ì™€í•‘ ë³€í˜•
  * `Roll Out`: ë‚®ì€ ìš°ì„ ìˆœìœ„ í”„ë¡œì„¸ìŠ¤ë¥¼ ìŠ¤ì™€í•‘ ì•„ì›ƒ
  * `Roll In`: ë†’ì€ ìš°ì„ ìˆœìœ„ í”„ë¡œì„¸ìŠ¤ë¥¼ ë¡œë“œí•˜ì—¬ ì‹¤í–‰
  * ëª©ì : CPU ìŠ¤ì¼€ì¤„ë§ íš¨ìœ¨ì„± í–¥ìƒ

ğŸ“**Ready Queue ê´€ë¦¬**  
* ì‹œìŠ¤í…œì€ <u>**ë””ìŠ¤í¬ì— ë©”ëª¨ë¦¬ ì´ë¯¸ì§€ê°€ ìˆëŠ” ready-to-run processë“¤ì˜ ready queueë¥¼ ìœ ì§€**</u>í•œë‹¤

{:.prompt-warning}
> backing storeì— ìˆë˜ í”„ë¡œì„¸ìŠ¤ê°€ ê°™ì€ physical addressë¡œ ëŒì•„ì™€ì•¼ í•˜ë‚˜?
>

â†’ ì£¼ì†Œ ë°”ì¸ë”© ë°©ë²•ì— ë”°ë¼ ë‹¤ë¦„!  
I/OëŠ” ë‚˜ê°”ë‹¤ ë“¤ì–´ì˜¬ ë•Œ ê°™ì€ ì£¼ì†Œë¡œ ë“¤ì–´ì™€ì•¼í•˜ê¸° ë•Œë¬¸ì— ì£¼ì†Œ ë°”ì¸ë”©ì— ë”°ë¼ ìš”êµ¬ë  ìˆ˜ë„ ìˆë‹¤. ê·¸ë˜ì„œ ì»¤ë„ì— ì‚¬ìš©ë˜ê²Œ ë” í•˜ê³  ìˆë‹¤ëŠ” ê²ƒì´ë‹¤

âš™ï¸**í˜„ëŒ€ ì‹œìŠ¤í…œì—ì„œì˜ Swapping**:  
* Modified Swapping (UNIX, Linux, Windows)
* ì¼ë°˜ì ìœ¼ë¡œ ë¹„í™œì„±í™”
* í˜„ì¬ í”„ë¡œì„¸ìŠ¤ ì¼ë¶€ë¥¼ ë‚´ë³´ë‚´ì§€ ì•Šìœ¼ë©´ deadlockì„ ê°ˆ ë•Œ, ì¦‰ ì„ê³„ì (threshold)ì¼ë•Œ í•  ìˆ˜ ì—†ì´ ë‚´ë³´ë‚´ì•¼í•¨

### Context Switch Time including Swapping
---
Context Switchingì€ CPUê°€ í•œ í”„ë¡œì„¸ìŠ¤ì—ì„œ ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ë¡œ ì „í™˜í•˜ëŠ” ê³¼ì •ì¸ë°, **Swappingì´ í¬í•¨ë˜ë©´ ì‹œê°„ì´ ê·¹ì ìœ¼ë¡œ ì¦ê°€í•¨**
![alt text](../assets/img/OS/cstis.png)

ë§Œì•½ ë‹¤ìŒì— CPUì—ì„œ ì‹¤í–‰ë  í”„ë¡œì„¸ìŠ¤ê°€ ë©”ëª¨ë¦¬ì— ì—†ëŠ” ê²½ìš°
* **í•„ìš”í•œ ì‘ì—…**: í˜„ì¬ processë¥¼ `swap out` + target processë¥¼ `swap in`
* â†’ **<span style="color: #008000">Context switch time can then be very high</span>**

#### êµ¬ì²´ì  ê³„ì‚° ì˜ˆì‹œ
![alt text](../assets/img/OS/cstisex.png)

âœ…ìŠ¤ì™€í•‘ ë©”ëª¨ë¦¬ ì–‘ì„ ì¤„ì—¬ì„œ ì„±ëŠ¥ì„ ìµœì í™” í•  ìˆ˜ ìˆë‹¤  
* **ì‹¤ì œë¡œ ì‚¬ìš©ë˜ëŠ” ë©”ëª¨ë¦¬ ì–‘ì„ íŒŒì•…í•˜ì—¬ ë¶ˆí•„ìš”í•œ ìŠ¤ì™€í•‘ ë°©ì§€**
* System callì„ í†µí•œ ë©”ëª¨ë¦¬ ì‚¬ìš© ì¶”ì 
  * `request_memory()` - ë©”ëª¨ë¦¬ ìš”ì²­ ì‹œ OSì— ì•Œë¦¼
  * `release_memory()` - ë©”ëª¨ë¦¬ í•´ì œ ì‹œ OSì— ì•Œë¦¼

âŒ**Swappingì˜ ì œì•½ ì‚¬í•­**:  
* **pending I/O ë¬¸ì œ**: I/O ì‘ì—…ì´ ì§„í–‰ ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ëŠ” Swapping ë¶ˆê°€ëŠ¥(I/Oê°€ ì˜ëª»ëœ í”„ë¡œì„¸ìŠ¤ì— ë°œìƒí•  ìˆ˜ ìˆê¸° ë•Œë¬¸)

* í•´ê²°ì±…: **double buffering**
  * í•­ìƒ I/Oë¥¼ ì»¤ë„ ê³µê°„ìœ¼ë¡œ ë¨¼ì € ì „ì†¡ í›„, I/O ì¥ì¹˜ë¡œ ì „ì†¡
  * ë‹¨ì : overhead ë°œìƒ
![alt text](../assets/img/OS/double_buffering.png)

í˜„ëŒ€ OSì—ì„œëŠ” standard Swappingì€ ì‚¬ìš© X
Modified Versionë§Œ ì‚¬ìš©í•¨

### Swapping on Mobile Systems
---
ëª¨ë°”ì¼ì—ì„œëŠ” swappingì´ ë” ë³µì¡í•´ì§„ë‹¤

* Flash memory ê¸°ë°˜
  * ê³µê°„ì´ ì‘ê³  write cycleì´ í•œì •ë˜ì–´ ìˆê¸° ë•Œë¬¸ì— ëª¨ë°”ì¼ì˜ CPUì™€ flash memory ì‚¬ì´ì— ì²˜ë¦¬ëŸ‰ì´ ì—„ì²­ ì‘ë‹¤

#### ë©”ëª¨ë¦¬ ê´€ë¦¬ ëŒ€ì•ˆ
![alt text](../assets/img/OS/swappingios.png)

![alt text](../assets/img/OS/swappingand.png)

* ê³µí†µ ê¸°ë²•: **Memory Compression**
  * ì‚¬ìš© ë¹ˆë„ê°€ ë‚®ì€ ë©”ëª¨ë¦¬ í˜ì´ì§€ë¥¼ ì••ì¶•

![alt text](../assets/img/OS/swappingpage.png)
> Swapping with Paging

âœ…**Pagingì˜ ì¥ì **:  
* ì„ íƒì  ìŠ¤ì™€í•‘: í•„ìš”í•œ í˜ì´ì§€ë§Œ ì´ë™
* ë¹ ë¥¸ ì„±ëŠ¥
* íš¨ìœ¨ì  ë©”ëª¨ë¦¬ ì‚¬ìš©

## Intel 32 and 64-bit Architectures
---
Pentium CPUëŠ” 32-bit IA-32 ì•„í‚¤í…ì²˜ì´ê³ , í˜„ì¬ Intel CPUëŠ” 64-bit IA-64 ì•„í‚¤í…ì²˜

ê° ì•„í‚¤í…ì³ì˜ êµ¬ì¡°ë¥¼ ì•Œì•„ë³´ì
### Intel IA-32 Architecture
---
* Intel IA-32ëŠ” **Segmentation + Paging** ë‘ ë°©ì‹ ëª¨ë‘ ì§€ì›
* **segment í¬ê¸°**: ìµœëŒ€ 4GB
* **í”„ë¡œì„¸ìŠ¤ ë‹¹ segment ê°œìˆ˜**: ìµœëŒ€ 16Kê°œ
* **í˜ì´ì§€ í¬ê¸°**: 4KB or 4MB
* ë‘ íŒŒí‹°ì…˜ìœ¼ë¡œ ë¶„í• :
  * ì²« ë²ˆì§¸ 8K: **Private** segment(kept in **<span style="color: #008000">local descriptor table(LDT)</span>**)
  * ë‘ ë²ˆì§¸ 8K: **Shared** segment(kept in **<span style="color: #008000">global descriptor table(GDT)</span>**)

âš™**CPU logical address** = (`selector`(16bits), `offset`(32bits))
![alt text](../assets/img/OS/IA32bitlogical_address.png)

* **Selector êµ¬ì„±**:
![alt text](../assets/img/OS/Iaselector.png)
> LTD, GTDì˜ ê° ì—”íŠ¸ë¦¬ëŠ” **8bytes segment descriptor**ë¡œ êµ¬ì„±  
> ì—¬ê¸°ì—ëŠ” segmentì˜ **base locationê³¼ limit ì •ë³´**ê°€ í¬í•¨ë¨

![alt text](../assets/img/OS/linearaddress.png)
> ì£¼ì†Œ ë³€í™˜ ê³¼ì • + linear address êµ¬ì„±

* **Segmentation**
![alt text](../assets/img/OS/Ia32Segmentation.png)
> IA-32 Segmentation

* **Paging ì•„í‚¤í…ì³**:
![alt text](../assets/img/OS/IA32pagingarchitecture.png)
> IA-32 Paging Architecture

![alt text](../assets/img/OS/IA32pagingarchiprodu.png)

#### Page Address Extensions (PAE)
ğŸ“š**<span style="color: #008000">Page Address Extensions (PAE)</span>**: 32-bit address limitìœ¼ë¡œ intelì´ ë§Œë“  í™•ì¥ ê¸°ìˆ 
* 32-bit appsì´ **4GB ì´ìƒì˜ ë©”ëª¨ë¦¬ ê³µê°„ì— ì ‘ê·¼ ê°€ëŠ¥**

âœ…**ì£¼ìš” ë³€í™”**:  
* **3-level Scheme**: Pagingì´ 3-levelë¡œ í™•ì¥
* Top 2 bitsê°€ **page directory pointer table** ì°¸ì¡°
* **64-bit entry**: Page-directoryì™€ page-table ì—”íŠ¸ë¦¬ í¬ê¸° í™•ì¥
* **36-bits - 64GB ë¬¼ë¦¬ ë©”ëª¨ë¦¬ê¹Œì§€ í™•ì¥**

![alt text](../assets/img/OS/PAE.png)
> PAE Structure

### Intel IA-64 Architecture
---
Intel x86-64ëŠ” **í˜„ì¬ ì„¸ëŒ€ Intel x86 ì•„í‚¤í…ì²˜**ë¡œ, 64-bit ì»´í“¨íŒ…ì˜ í˜„ëŒ€ì  êµ¬í˜„
* ì´ë¡ ì  ì£¼ì†Œ: `64bits(> 16 exabytes)` ì—„ì²­ í¼!
* ì‹¤ì œ êµ¬í˜„: **48bit ì£¼ì†Œ**ë§Œ ì‚¬ìš©
* page size: `4KB`, `2MB`, `1GB`
* paging level: **4-level hierarchy**
![alt text](../assets/img/OS/IA_64_Architecture.png)

* PAE í™•ì¥ ê¸°ëŠ¥
  * **virtual addresses**: `48bits (256TB)`
  * **physical addresses**: `52bits (4PB)`

#### Example: ARM Architecture
![alt text](../assets/img/OS/ARM_Architecture.png)

![alt text](../assets/img/OS/ARM_Architectureinfo.png)