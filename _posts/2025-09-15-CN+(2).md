---
title: "[🌐CN] Internet Protocol(2) - IP Addressing"

categories: [CS, Internet Protocol]
tags:
  - [CS, Internet Protocol, Computer Networking, Network layer, IP Addressing, CIDR, Subnetting]
toc: true
toc_sticky: true

date: 2025-09-15
last_modified_at: 2025-09-15
---
>🌐 Internet Protocol 전공 수업 정리

*IP 주소는 인터넷에서 호스트를 식별하는 핵심 요소다. 단순해 보이는 32비트 주소 체계 뒤에는 네트워크 효율성, 확장성, 그리고 라우팅 최적화를 위한 정교한 설계 철학이 숨어있다. Classful에서 CIDR로, 그리고 Subnetting까지 - IP 주소 체계의 진화를 살펴보자.*

-----

## **IP Address 설계 철학**

### Designing IP's Addresses의 핵심 질문들

**Question #1: What should an address be associated with?**
* 전화번호는 "사람"이 아닌 "handset(단말기)"과 연결됨
* **IP 주소는 "호스트"가 아닌 "네트워크 인터페이스"와 연결됨**

**Question #2: What structure should addresses have?**
* 주소 구조가 라우팅 효율성에 미치는 영향
* 계층적 구조 vs 평면 구조의 장단점

**Question #3: Who determines the particular addresses?**
* 전 세계 IP 주소 관리 체계
* 중앙 집중식 할당의 필요성

### Connectivity의 3요소

```
1. Addressing  → IP (어디로 보낼 것인가?)
2. Forwarding  → IP (어떻게 보낼 것인가?)
3. Routing     → Routing Protocol (최적 경로는?)
```

-----

## **IP Address 기본 구조**

### What is an IP Address?

📚**<span style="color: #008000">IP Address</span>**: 네트워크 인터페이스를 식별하는 32bit 길이의 고유한 글로벌 주소

**핵심 특징:**
* **32 bit** 길이의 식별자
* **Network prefix** (네트워크 번호) + **Host number** (호스트 번호)로 구성
* 기본적으로 네트워크 인터페이스마다 고유함

**예외 사항:**
* **DHCP**: 동적으로 할당되는 IP 주소
* **NAT**: Private 네트워크 내부 IP 주소

### IP Address 구조

```
┌─────────────────┬──────────────────┐
│ Network Prefix  │  Host Number     │
└─────────────────┴──────────────────┘
      32 bits 중 일부      나머지
```

**IP Header 내의 위치:**

```
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
├───┼───┼───────────┼───────────────────────────────────────────┤
│Ver│IHL│    ToS    │          Total Length                     │
├───────────────────┼───────┬───┬───────────────────────────────┤
│   Identification  │ Flags │   Fragment Offset                 │
├───────────────────┼───────┴───────────────────────────────────┤
│   TTL             │Protocol│      Header Checksum             │
├───────────────────┴────────┴───────────────────────────────────┤
│                    Source IP address (32 bits)                │
├───────────────────────────────────────────────────────────────┤
│                 Destination IP address (32 bits)              │
└───────────────────────────────────────────────────────────────┘
```

-----

## **Dotted Decimal Notation**

### 표기 방식

📚**<span style="color: #008000">Dotted Decimal Notation</span>**: 각 바이트(8bit)를 십진수로 표현하고 점(.)으로 구분하는 표기법

* 각 바이트를 0~255 범위의 십진수로 표현
* 총 4개의 8비트 필드

### 변환 예시

```
Binary:  10100110 01101000 11101111 01100000
         ────┬──── ────┬─── ────┬─── ────┬────
            166      104      239       96

Dotted Decimal: 166.104.239.96
```

**실제 IP 헤더 예시:**

```
0x4 0x5  0x00      4410
9d08     0102      00000000000002
128.143.137.144              ← Source IP
128.143.71.21                ← Destination IP
12810    0x06      8bff
```

-----

## **IP Address의 용도**

### What Are Addresses Used For?

**라우팅의 핵심:**
* 네트워크는 주소를 보고 패킷을 어디로 전달할지 결정
* **Router**: IP 주소 기반으로 패킷을 포워딩하는 네트워크 장치
* **Switch**: Layer-2 주소(MAC 주소) 기반으로 동작

**Router vs Switch:**

| 구분       | Layer   | 주소 타입   | 역할                  |
| :--------- | :------ | :---------- | :-------------------- |
| **Router** | Layer 3 | IP Address  | 네트워크 간 패킷 전달 |
| **Switch** | Layer 2 | MAC Address | 동일 네트워크 내 전달 |

-----

## **IP Address 소유권 및 관리**

### Who owns the IP addresses?

📚**<span style="color: #008000">ICANN</span>**: Internet Corporation for Assigned Names and Numbers - IP 주소 관리 및 배분을 담당하는 비영리 법인

**글로벌 IP 주소 관리 계층 구조:**

```
                    ┌──────────┐
                    │  ICANN   │
                    │(Root 관리)│
                    └────┬─────┘
                         │
               ┌─────────┴──────────┐
               │       IANA          │
               │  (실제 주소 할당)    │
               └─────────┬──────────┘
                         │
         ┌───────┬───────┼───────┬──────┬────────┐
         │       │       │       │      │        │
      ┌──▼──┐ ┌─▼───┐ ┌─▼────┐ ┌▼───┐ ┌▼────┐  │
      │ARIN │ │RIPE │ │APNIC │ │... │ │ ... │  │
      │(북미)│ │(유럽)││(아태)│ │    │ │     │  │
      └──┬──┘ └──┬──┘ └──┬───┘ └────┘ └─────┘  │
         │       │       │                       │
         │       │     ┌─▼────┬──────────┬─────┐│
         │       │     │JPNIC │  KRNIC   │ ... ││
         │       │     └──────┤ (한국)   ├─────┘│
         │       │            └────┬─────┘       │
         │       │                 │             │
         │       │        ┌────┬───▼──┬─────┬───▼────┐
         │       │        │ KT │  SK  │Korea│  ...   │
         │       │        │    │Broad │Univ.│        │
         │       │        └────┴──┬───┴─────┴────────┘
         │       │                │
         │       │           ┌────▼────┬─────┐
         │       │           │  Alice  │ Bob │
         │       │           └─────────┴─────┘
```

**지역별 관리 기관:**
* **ARIN**: 북미 (American Registry for Internet Numbers)
* **RIPE NCC**: 유럽 (Réseaux IP Européens Network Coordination Centre)
* **APNIC**: 아시아태평양 (Asia-Pacific Network Information Centre)
* **KRNIC**: 한국 (Korea Network Information Center)

**실제 배분:**
* **ISP**: KT, SK Broadband 등 인터넷 서비스 제공자
* 일반 사용자는 ISP로부터 IP 주소 할당받음

-----

## **Network Prefix와 Host Number**

### 주소의 2계층 구조

```
┌─────────────────┬──────────────────┐
│ Network Prefix  │  Host Number     │
│ (네트워크 식별) │  (호스트 식별)   │
└─────────────────┴──────────────────┘
```

**Network prefix의 길이 결정:**
* **1993년 이전**: Classful Addressing (암묵적으로 정의됨)
* **1993년 이후**: Netmask로 명시 (CIDR)

### 실제 예시: sw.hanyang.ac.kr

```
IP Address:   166.104.239.96
              ────┬──── ───┬───
              166.104   239.96
Network Address: 166.104.0.0 (or 166.104)
Host Number:     239.96
Netmask:         255.255.0.0 (or ffff0000)

CIDR Notation:   166.104.239.96/16
                 ─────────────┬─ ─┬
                      주소     │  │
                              └──┴─ 16비트가 network prefix
```

{:.prompt-info}
> **CIDR 표기법**: `/16`은 왼쪽에서부터 16비트가 네트워크 프리픽스라는 의미

-----

## **Classful IP Addresses (1980s~1993)**

### 클래스 기반 주소 체계

📚**<span style="color: #008000">Classful Addressing</span>**: 초기 인터넷 주소를 Class A/B/C로 구분하여 암묵적으로 네트워크 크기를 결정하는 방식

**클래스 구분:**
* **Class A**: Network prefix는 **8 bits** (0으로 시작)
* **Class B**: Network prefix는 **16 bits** (10으로 시작)
* **Class C**: Network prefix는 **24 bits** (110으로 시작)
* **Class D**: Multicast (1110으로 시작)
* **Class E**: 예비용 (1111로 시작)

### Class별 구조

**Class A:**
```
 0   7 8                                               31
├─┬───┴──────────────────────────────────────────────────┤
│0│  Network (7 bits)  │      Host (24 bits)            │
└─┴────────────────────┴────────────────────────────────┘
Networks: 128 (2^7)
Hosts/Network: 16,777,216 (2^24)
```

**Class B:**
```
 0 1   15 16                                            31
├─┬─┬───┴──────────────────┬────────────────────────────┤
│1│0│ Network (14 bits)    │   Host (16 bits)           │
└─┴─┴──────────────────────┴────────────────────────────┘
Networks: 16,384 (2^14)
Hosts/Network: 65,536 (2^16)
```

**Class C:**
```
 0 1 2   23 24                                          31
├─┬─┬─┬───┴──────────────────────────┬───────────────────┤
│1│1│0│  Network (21 bits)           │ Host (8 bits)     │
└─┴─┴─┴──────────────────────────────┴───────────────────┘
Networks: 2,097,152 (2^21)
Hosts/Network: 256 (2^8)
```

### Class별 주소 범위

| 클래스 | 주소 범위                 | 상위 비트 | 용도                   | 전체 비율 | 네트워크 수 | 호스트 수  |
| :----- | :------------------------ | :-------- | :--------------------- | :-------- | :---------- | :--------- |
| **A**  | 0.0.0.0~127.255.255.255   | 0         | 유니캐스트/특별한 용도 | 1/2       | 128         | 16,777,216 |
| **B**  | 128.0.0.0~191.255.255.255 | 10        | 유니캐스트/특별한 용도 | 1/4       | 16,384      | 65,536     |
| **C**  | 192.0.0.0~223.255.255.255 | 110       | 유니캐스트/특별한 용도 | 1/8       | 2,097,152   | 256        |
| **D**  | 224.0.0.0~239.255.255.255 | 1110      | 멀티캐스트             | 1/16      | 해당 없음   | 해당 없음  |
| **E**  | 240.0.0.0~255.255.255.255 | 1111      | 예비용                 | 1/16      | 해당 없음   | 해당 없음  |

### IP Address Space 분포

```
  0.0.0.0         128.0.0.0      192.0.0.0   224.0.0.0  240.0.0.0
     │                │               │           │         │
┌────▼────────────────▼───────────────▼───────┬───▼───┬─────▼──┐
│         A          │       B       │   C    │   D   │   E    │
└────────────────────┴───────────────┴────────┴───────┴────────┘
     50%                25%            12.5%    6.25%   6.25%
```

-----

## **Classful Addressing의 문제점**

### 3 Big Problems (1990년대 초)

**❌ Problem 1: 주소 고갈**
* 1994년까지 **Class B 주소의 50% 이상**이 이미 할당됨
* 1995년쯤 Class B 주소가 완전히 고갈될 것으로 예상
* Class A, Class B 주소가 모두 소진됨

**❌ Problem 2: Flat Address Space**
* 백본 라우터의 라우팅 테이블에 **모든 네트워크 주소마다 엔트리** 필요
* Class C 네트워크가 널리 사용되면서 라우팅 테이블 크기 폭발
* 1993년 기준 라우팅 테이블이 **65,000개** 엔트리로 성장
* 라우터 성능 저하 우려

**❌ Problem 3: 유연성 부족**
* Class A/B는 너무 큼 (>64,000 호스트)
* Class C는 너무 작음 (254 호스트)
* 예: 10,000개 호스트가 필요한 조직
  * Class B는 과도함 (54,000개 낭비)
  * Class C는 부족함 (40개 필요 → 라우팅 테이블 40개 엔트리)

### Classful Address 할당 추이

**네트워크 할당 증가 그래프 (1983-1995):**

```
Networks
(thousands)
    70│                                            ⬛
    60│                                    ⬛
    50│                              ⬛
    40│                         ⬛
    30│
    20│                   ⬛                        ⬜ Class A
    10│             ⬛                              🟥 Class B
     0│⬛ ⬛ ⬛ ⬛ ⬛═══🟥═══🟥═══🟥═══🟥══🟥       ⬛ Class C
      └─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─
      1983  1985  1987  1989  1991  1993  1995
```

{:.prompt-warning}
> **"The End of the World? Not quite yet"** (1990년 기사)
> Class B 주소 풀이 고갈되면서 인터넷 종말론이 제기되었으나, CIDR의 도입으로 위기를 극복

-----

## **CIDR: Classless Inter-Domain Routing**

### CIDR의 등장 (1993년)

📚**<span style="color: #008000">CIDR (Classless Inter-Domain Routing)</span>**: Class 개념을 없애고 가변 길이 네트워크 프리픽스를 사용하는 주소 체계

**Goals:**
* IP 주소 공간의 새로운 해석
* IP 주소 할당 효율성 증대
* Route aggregation을 통한 라우팅 테이블 최소화

**Features:**
* ❌ **No classes!** 클래스 개념 완전 폐기
* ✅ Network prefix 길이를 자유롭게 지정
* ✅ `/x` 표기법으로 prefix 길이 명시

### CIDR Addressing 구조

```
Network number = IP address + Mask

IP Address:  12.4.0.0
IP Mask:     255.254.0.0

Binary 표현:
Address:  00001100 00000100 00000000 00000000
Mask:     11111111 11111110 00000000 00000000
          ───────────────┬──────────┴──────────
          Network Prefix (15 bits)  | Hosts

CIDR Notation: 12.4.0.0/15 또는 12.4/15
```

### CIDR Address Blocks

**일반적인 CIDR 블록 크기:**

| CIDR Prefix | 호스트 수 | 비트 계산 | 용도 예시          |
| :---------- | :-------- | :-------- | :----------------- |
| /27         | 32        | 2^5       | 소규모 사무실      |
| /26         | 64        | 2^6       | 작은 건물          |
| /25         | 128       | 2^7       | 중소 기업          |
| /24         | 256       | 2^8       | 일반 서브넷        |
| /23         | 512       | 2^9       | 중간 규모 네트워크 |
| /22         | 1,024     | 2^10      | 대학 건물          |
| /21         | 2,048     | 2^11      | 캠퍼스 네트워크    |
| /20         | 4,096     | 2^12      | 작은 ISP           |
| /19         | 8,192     | 2^13      | 중간 ISP           |
| /18         | 16,384    | 2^14      | 대형 기업          |
| /17         | 32,768    | 2^15      | 큰 ISP             |
| /16         | 65,536    | 2^16      | 대형 네트워크      |

**주소 범위 예시:**

| Prefix             | Binary (일부)                       | Address Range             |
| :----------------- | :---------------------------------- | :------------------------ |
| 0.0.0.0/0          | 00000000 00000000 00000000 00000000 | 0.0.0.0~255.255.255.255   |
| 128.0.0.0/1        | 10000000 00000000 00000000 00000000 | 128.0.0.0~255.255.255.255 |
| 128.0.0.0/24       | 10000000 00000000 00000000 00000000 | 128.0.0.0~128.0.0.255     |
| 198.128.128.192/27 | 11000110 10000000 10000000 11000000 | 198.128.128.192~223       |
| 165.195.130.107/32 | 10100101 11000011 10000010 01101011 | 165.195.130.107           |

-----

## **CIDR와 Address Assignments**

### ISP 기반 계층적 할당

**배경:**
* Backbone ISP가 큰 IP 주소 블록을 할당받음
* 그 블록을 고객들에게 재할당

**예시 시나리오:**
```
ISP가 소유: 206.0.64.0/18 (16,384개 주소)
고객이 필요: 800개 호스트

Classful 방식:
  ❌ Class B 할당 → 64,700개 낭비
  ❌ Class C 4개 할당 → 라우팅 테이블 4개 엔트리

CIDR 방식:
  ✅ /22 블록 할당 (206.0.68.0/22)
  ✅ 1,024개 주소 할당
  ✅ 라우팅 테이블 1개 엔트리만 필요!
```

### Hierarchical Address Allocation

```
                    12.0.0.0/8
                        │
          ┌─────────────┼─────────────┐
          │             │             │
     12.0.0.0/15   12.2.0.0/16   12.253.0.0/16
          │             │             │
      ┌───┴───┐     ┌───┴───┐     ┌───┴────┐
  12.3.0.0/22 ...  12.3.4.0/24   12.253.0.0/19  ...
      │                 │             │
  12.3.4.0/24      12.3.254.0/23  12.253.64.0/19
      │                             ├── 12.253.64.108/30
      :                             ├── 12.253.96.0/18
                                    └── 12.253.128.0/17
```

**Prefix 기반 라우팅의 장점:**
* 인터넷 확장성 향상
* 연속적인 청크(prefix) 단위로 주소 할당
* Prefix 기반 라우팅으로 테이블 크기 최소화

-----

## **Route Aggregation (경로 집약)**

### Scalability: Address Aggregation

📚**<span style="color: #008000">Route Aggregation</span>**: 여러 개의 작은 네트워크를 하나의 큰 prefix로 통합하여 라우팅 테이블 크기를 줄이는 기법

**예시:**

```
Provider: 201.10.0.0/21 할당받음 (201.10.0.x ~ 201.10.7.x)

        ┌─────────────────┐
        │    Provider     │
        └────────┬────────┘
          201.10.0.0/21   ← 외부 라우터는 이것만 알면 됨!
                 │
    ┌────────────┼────────────┬──────────┐
    │            │            │          │
201.10.0.0/22 201.10.4.0/24 201.10.5.0/24 201.10.6.0/23
 (Customer 1)  (Customer 2)  (Customer 3)  (Customer 4)
```

**핵심 장점:**
* 외부 인터넷 라우터는 **201.10.0.0/21 하나만** 알면 됨
* Provider가 내부적으로 적절한 고객에게 전달
* 라우팅 테이블 크기 획기적 감소

### CIDR and Routing Information

**복잡한 계층 구조 예시:**

```
                    ┌─────────────┐
                    │  Internet   │
                    │  Backbone   │
                    └──────┬──────┘
                           │
                    ┌──────▼──────┐
                    │   ISP X     │
                    │  owns:      │
                    │ 206.0.64/18 │
                    │ 204.188.0/15│
                    │ 209.88.232/21│
                    └──┬────────┬─┘
                       │        │
          ┌────────────┘        └────────────┐
          │                                  │
    ┌─────▼─────┐                    ┌──────▼──────┐
    │Company X  │                    │   ISP y     │
    │206.0.68/22│                    │209.88.237/24│
    └───────────┘                    └──┬──────┬───┘
                                        │      │
                             ┌──────────┘      └──────────┐
                             │                            │
                       ┌─────▼─────┐              ┌───────▼──────┐
                       │  Org z1   │              │   Org z2     │
                       │209.88.237 │              │ 209.88.237   │
                       │   .192/26 │              │    .0/26     │
                       └───────────┘              └──────────────┘
```

**라우팅 정보 전파:**
1. **Backbone → ISP X**: "206.0.64/18, 204.188.0/15, 209.88.232/21로 가는 트래픽 모두 ISP X로"
2. **ISP X → Company X**: "206.0.68/22"
3. **ISP X → ISP y**: "209.88.237/24"
4. **ISP y → Organizations**: "209.88.237.192/26" vs "209.88.237.0/26"

{:.prompt-tip}
> **계층적 라우팅의 핵심**: Backbone은 Company X, ISP y, Organizations를 전혀 몰라도 됨!

-----

## **SUBNET (서브넷팅)**

### Subnetting의 필요성

**Problem:**
* 조직 내부에 여러 독립적으로 관리되는 네트워크가 존재
* 각각에 별도의 네트워크 주소를 할당하면 관리가 어려움

```
         ┌───────────────────────────┐
         │   University Network      │
         │                           │
         │   ┌──────────┐            │
         │   │Engineering│            │
         │   │  School   │            │
         │   └──────────┘             │
         │                           │
         │  ┌──────┐   ┌─────────┐  │
         │  │Medical│   │ Library │  │
         │  │School │   └─────────┘  │
         │  └──────┘                 │
         └───────────────────────────┘
```

**Solution 1: 각 네트워크에 별도 주소 할당**
* ❌ 관리 어려움
* ❌ 외부에서 각각 addressable해야 함

**Solution 2: Subnetting**
* ✅ IP 주소 구조에 한 단계 계층 추가
* ✅ 내부적으로만 서브넷 구조 사용
* ✅ 외부에서는 단일 네트워크로 보임

### Basic Idea of Subnetting

**개념:**
* Host number 부분을 **Subnet number**와 **(더 작은) Host number**로 분할
* 3계층 구조 형성

**구조 변화:**

```
Before:
┌─────────────────┬──────────────────────────┐
│ Network Prefix  │     Host Number          │
└─────────────────┴──────────────────────────┘

After:
┌─────────────────┬──────────────┬───────────┐
│ Network Prefix  │Subnet Number │Host Number│
└─────────────────┴──────────────┴───────────┘
                 Extended Network Prefix
```

**장점:**
* ✅ 서브넷을 조직 내에서 자유롭게 할당
* ✅ 내부적으로 분리된 네트워크로 취급
* ✅ 외부에서는 서브넷 구조 불가시

-----

## **Subnetmask**

### Subnet Mask의 역할

📚**<span style="color: #008000">Subnetmask</span>**: Extended network prefix(서브넷까지 포함한 네트워크 부분)의 길이를 나타내는 비트 마스크

**예시:**

```
IP Address:    128.143.137.144
Subnetmask:    255.255.255.0

Binary:
Address:  10000000 10001111 10001001 10010000
Mask:     11111111 11111111 11111111 00000000
          ─────────────────────────┬─ ────┬───
          Extended Network Prefix    Host Number
          (Network + Subnet)
```

**주소 구조 해석:**

| 부분                | 값               | 설명          |
| :------------------ | :--------------- | :------------ |
| **Network**         | 128.143          | 네트워크 주소 |
| **Subnet**          | 137              | 서브넷 번호   |
| **Host**            | 144              | 호스트 번호   |
| **Network Address** | 128.143.0.0/16   | 전체 네트워크 |
| **Subnet Address**  | 128.143.137.0/24 | 서브넷 주소   |
| **Host Address**    | 128.143.137.144  | 호스트 주소   |

### Subnet 예시

**Hanyang University (166.104.0.0/16):**

```
              ┌───────────────────────┐
              │  166.104.0.0/16       │
              │  University Network   │
              └───────┬───────────────┘
                      │
      ┌───────────────┼───────────────┬───────────┐
      │               │               │           │
 166.104.239.0/24 166.104.231.0/24  166.104.102.0/24  166.104.45.0/24
 Engineering       Medical          Library          Admin
```

**각 서브넷은 독립적으로 관리:**
* sw.hanyang.ac.kr: **166.104.239.96**
  * Network: 166.104
  * Subnet: 239
  * Host: 96
  * Subnetmask: **255.255.255.0** (/24)

-----

## **Subnetting 동작 원리**

### No Subnetting

**문제 상황:**

```
┌──────────┐   ┌──────────┐   ┌──────────┐   ┌──────────┐
│  .137.32 │   │ .137.144 │   │  .71.21  │   │ .71.201  │
│  /16     │   │   /16    │   │   /16    │   │  /16     │
└────┬─────┘   └────┬─────┘   └────┬─────┘   └────┬─────┘
     └──────────────┴──────────────┴──────────────┘
                    128.143.70.0/16
              (모두 같은 네트워크로 인식)
```

* Subnetmask: **255.255.0.0** (/16)
* 모든 호스트가 서로를 **같은 네트워크**에 있다고 생각
* 실제로는 물리적으로 분리되어 있어도!

### With Subnetting

**올바른 구성:**

```
┌──────────┐   ┌──────────┐         ┌──────────┐   ┌──────────┐
│  .137.32 │   │ .137.144 │         │  .71.21  │   │ .71.201  │
│  /24     │   │   /24    │         │   /24    │   │  /24     │
└────┬─────┘   └────┬─────┘         └────┬─────┘   └────┬─────┘
     └──────────────┘                     └──────────────┘
    128.143.137.0/24                     128.143.71.0/24
       Subnet 1                              Subnet 2
     ─────────────────────┬───────────────────────────
                    128.143.0.0/16
```

* Subnetmask: **255.255.255.0** (/24)
* **Extended network prefix가 같은 호스트들만** 같은 네트워크
* 서브넷 간에는 라우터 필요

### 서브넷 예시 (한양대학교)

```
                       ┌──────────┐
                       │ Internet │
                       └─────┬────┘
                             │ 128.32.x.x를 오가는
                             │ 모든 트래픽
                    ┌────────▼────────┐
                    │   사이트 경계    │
                    │     라우터      │
                    └────┬─────────┬──┘
                         │         │
            128.32.1.1   │         │  128.32.2.9
                         │         │
            ┌────────────▼──┐   ┌──▼────────────┐
            │ 128.32.1.x    │   │ 128.32.2.x    │
            └───┬───────┬───┘   └───┬───────┬───┘
                │       │           │       │
           128.32.1.14  ...    128.32.2.122 ...

사이트 전체에 대한 서브넷 마스크: 255.255.255.0
```

-----

## **VLSM (Variable Length Subnet Mask)**

### VLSM 개념

📚**<span style="color: #008000">VLSM</span>**: 하나의 네트워크 내에서 서브넷마다 다른 길이의 서브넷 마스크를 사용하는 기법

**특징:**
* 모든 서브넷이 동일한 크기일 필요 없음
* 필요에 따라 서브넷을 더 작은 서브넷으로 분할 가능
* 주소 공간 효율적 사용

### VLSM 예시: 계층적 분할

**Original Network: 201.45.222.0/24 (254 hosts)**

```
Step 1: /24를 /25 두 개로 분할
┌────────────────────────────────────────────────┐
│  201  │  45  │  222  │ 0  │  126 Hosts         │ 201.45.222.0/25
├────────────────────────────────────────────────┤
│  201  │  45  │  222  │ 1  │  126 Hosts         │ 201.45.222.128/25
└────────────────────────────────────────────────┘

Step 2: 201.45.222.128/25를 /26 두 개로 분할
┌────────────────────────────────────────────────┐
│  201  │  45  │  222  │ 1 │ 0 │  62 Hosts       │ 201.45.222.128/26
├────────────────────────────────────────────────┤
│  201  │  45  │  222  │ 1 │ 1 │  62 Hosts       │ 201.45.222.192/26
└────────────────────────────────────────────────┘

Step 3: 201.45.222.192/26을 /28 네 개로 분할
┌────────────────────────────────────────────────┐
│  201  │  45  │  222  │ 1 │ 1 │ 0 │ 0 │ 14 Hosts│ 201.45.222.192/28
├────────────────────────────────────────────────┤
│  201  │  45  │  222  │ 1 │ 1 │ 0 │ 1 │ 14 Hosts│ 201.45.222.208/28
├────────────────────────────────────────────────┤
│  201  │  45  │  222  │ 1 │ 1 │ 1 │ 0 │ 14 Hosts│ 201.45.222.224/28
├────────────────────────────────────────────────┤
│  201  │  45  │  222  │ 1 │ 1 │ 1 │ 1 │ 14 Hosts│ 201.45.222.240/28
└────────────────────────────────────────────────┘
```

### VLSM 실제 네트워크 예시

```
                          128.32.0.0/16
                    ┌──────────┴──────────┐
                    │   Site Border       │
                    │     Router          │
                    └──┬───────────────┬──┘
         128.32.1.1/24│               │128.32.2.9/24
                      │               │
         ┌────────────▼┐             ┌▼─────────────┐
         │128.32.1.0/24│             │Internal      │
         │(256 hosts)  │             │Router        │
         └─────────────┘             └┬──────┬──────┘
         128.32.1.14                  │      │
                          128.32.230.129/26  │128.32.2.126/24
                             (64 hosts)      │
                                 128.32.230.{128-191}/26
                                             │128.32.2.130/25
                                             │
                                    128.32.2.{128-255}/25
                                       (128 hosts)
```

**호스트 수 계산:**
* /24: 2^8 = 256 hosts
* /25: 2^7 = 128 hosts
* /26: 2^6 = 64 hosts

-----

## **Scalability Improved with CIDR**

### Number Related Hosts with Same Prefix

**예시 네트워크:**

```
LAN 1: 1.2.3.0/24                     LAN 2: 5.6.7.0/24
┌──────┬──────┬────────┐         ┌──────┬──────┬────────┐
│1.2.3.│1.2.3.│1.2.3.  │         │5.6.7.│5.6.7.│5.6.7.  │
│  .4  │  .7  │  .156  │   ...   │  .8  │  .9  │  .212  │
└──┬───┴──┬───┴───┬────┘         └──┬───┴──┬───┴───┬────┘
   │      │       │                 │      │       │
   └──────┴───────┴─────┬───────────┴──────┴───────┘
                        │
                    ┌───▼───┐    WAN    ┌────────┐    WAN
                    │Router │─────────○─│ Router │─────────
                    └───────┘            └────────┘

Forwarding Table:
┌──────────────┬─────────┐
│ 1.2.3.0/24   │ → LAN 1 │
│ 5.6.7.0/24   │ → LAN 2 │
└──────────────┴─────────┘
```

### Easy to Add New Hosts

**새로운 호스트 추가 (5.6.7.213):**

```
LAN 2에 새로운 호스트 5.6.7.213 추가
         ↓
라우터 업데이트 필요 없음!
         ↓
5.6.7.0/24 prefix에 이미 매치됨 ✅
```

**장점:**
* 라우터의 포워딩 테이블 업데이트 불필요
* prefix 기반 매칭으로 자동으로 처리됨
* 확장성 극대화

-----

## **Subnetting의 장점**

### Advantages of Subnetting

**3계층 구조:**
1. **Network**: 전체 조직 네트워크
2. **Subnet**: 부서/건물별 네트워크
3. **Host**: 개별 호스트

**핵심 장점:**

**✅ 1. 라우터 복잡도 감소**
* 외부 라우터는 서브넷 구조를 알 필요 없음
* 라우팅 테이블 크기 감소

**✅ 2. 유연한 관리**
* 각 서브넷을 독립적으로 관리
* VLSM으로 효율적 주소 할당

**✅ 3. 보안 및 성능**
* 브로드캐스트 도메인 분리
* 네트워크 트래픽 격리

{:.prompt-tip}
> **Note**: 서브넷 마스크 길이는 모든 서브넷에서 동일할 필요 없음 → **VLSM** 가능!

-----

## **Special IP Addresses**

### 1. Multicast Address (Class D)

📚**<span style="color: #008000">Multicast Address</span>**: 하나의 패킷을 여러 인터페이스에 전송하는 1:many 통신

**특징:**
* Source IP: 전송자의 IP 주소 **사용하지 않음**
* 해당 multicast group 주소 사용

**주요 Multicast 주소:**
* **224.0.0.1**: All hosts (모든 인터페이스)
* **224.0.0.2**: All routers (모든 라우터)

**범위:**

| Range Start | Range End       | Description                     |
| :---------- | :-------------- | :------------------------------ |
| 224.0.0.0   | 224.0.0.255     | Well-known multicast addresses  |
| 224.0.1.0   | 238.255.255.255 | Globally-scoped (Internet-wide) |
| 239.0.0.0   | 239.255.255.255 | Administratively-scoped (local) |

### 2. Broadcast Address

📚**<span style="color: #008000">Broadcast Address</span>**: 네트워크의 모든 호스트에게 전달되는 주소

**계산 방법:**
```
Network/Subnetwork 부분 → 해당 값
Host 필드의 모든 비트 → 1

예시: 128.32.1.0/24
Address:       10000000 00100000 00000001 00001110
Complement     00000000 00000000 00000000 11111111
of Mask:
OR Result:     10000000 00100000 00000001 11111111
               → 128.32.1.255 (Broadcast Address)
```

**두 가지 유형:**

**1. Limited Broadcast: 255.255.255.255**
* ✅ Subnet 안에서만 전달
* ❌ 외부로 나가지 않음
* 사용 예: `ping -b 255.255.255.255`

**2. Directed Broadcast**
* **Net-directed**: 166.63.255.255
* **Subnet-directed**: 166.63.160.255

**Smurf Attack (보안 이슈):**

```
공격자의 악의적 행동:
  1. Ping request 생성 (Src_IP: 피해자 IP)
  2. 네트워크의 모든 호스트에게 broadcast
  3. 모든 호스트가 피해자에게 reply
  → 피해자 DDoS 공격 당함!

방어:
  → 대부분의 라우터는 directed broadcast를 discard함
```

{:.prompt-warning}
> **보안**: 현대 라우터는 directed broadcast를 기본적으로 차단하여 Smurf attack을 방지함

### 3. Private Addresses (RFC 1918)

📚**<span style="color: #008000">Private Address</span>**: 외부 인터넷에서 라우팅되지 않는 내부 전용 IP 주소

**용도:**
* 🔒 "실험적 용도"로 예약됨
* 외부 인터넷으로 패킷이 나가면 drop됨
* NAT와 함께 사용

**범위:**

| Class | Address Range                 | CIDR           | 총 주소 수 |
| :---- | :---------------------------- | :------------- | :--------- |
| **A** | 10.0.0.0 ~ 10.255.255.255     | 10.0.0.0/8     | 16,777,216 |
| **B** | 172.16.0.0 ~ 172.31.255.255   | 172.16.0.0/12  | 1,048,576  |
| **C** | 192.168.0.0 ~ 192.168.255.255 | 192.168.0.0/16 | 65,536     |

### 4. Loopback Address

**127.0.0.1 ~ 127.255.255.255**
* Name: **"localhost"**
* 대부분의 시스템은 **127.0.0.1** 사용
* 자기 자신과의 통신용

### 5. This Machine

**0.0.0.0**
* IP 주소가 할당되기 전 임시로 사용
* DHCP 요청 시 사용

### 6. Convention (예약 주소 아님)

**Default Gateway**
* Host number를 **'1'**로 설정하는 관례
* 예: 192.0.1.1, 10.0.0.1

-----

## **정리**

### IP Addressing의 진화

```
1980s: Classful Addressing
  ↓ (주소 고갈, 라우팅 테이블 폭발)
1993: CIDR 도입
  ↓ (유연성, Route Aggregation)
현재: CIDR + Subnetting + VLSM
```

### 핵심 개념 요약

| 개념           | 설명                                  | 장점                      |
| :------------- | :------------------------------------ | :------------------------ |
| **Classful**   | Class A/B/C로 암묵적 prefix 길이 결정 | 단순함                    |
| **CIDR**       | 가변 길이 prefix (/x 표기)            | 유연성, Route Aggregation |
| **Subnetting** | 조직 내부 네트워크 분할               | 관리 용이, 보안           |
| **VLSM**       | 서브넷마다 다른 길이 마스크           | 주소 효율성               |

{:.prompt-info}
> **현대 인터넷의 핵심**: CIDR의 Route Aggregation과 Subnetting의 조합으로 인터넷의 확장성을 확보!

-----

## **References**

* RFC 826 (ARP)
* RFC 1918 (Private Address Space)
* RFC 4632 (CIDR)
* Prof. Jongwon Yoon, Intelligent Machines Lab
