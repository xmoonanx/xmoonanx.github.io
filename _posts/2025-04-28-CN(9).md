---
title: "[CS] Computer Networking - Network layer(1)"

categories: [CS, Computer Networking]
tags:
  - [CS, Computer Networking, Network layer]
toc: true
toc_sticky: true

date: 2025-04-28
last_modified_at: 2025-04-28
---
>ğŸ“šì»´í“¨í„° ë„¤íŠ¸ì›Œí¬ ì „ê³µ ìˆ˜ì—… ì •ë¦¬

## Network Layer
---
![alt text](../assets/img/Computer_Network/allayer.png)

ğŸ“š**NewworkLayer**: ë°ì´í„°ì˜ ê²½ë¡œ ì„¤ì •ê³¼ ì „ë‹¬ì„ ë‹´ë‹¹
  
* **í•µì‹¬ê¸°ëŠ¥:**
1. `sending host`ì—ì„œ `receiving host`ë¡œ **trasport segment** ì „ë‹¬
2. sending ì¸¡ì—ì„œ segmentë¥¼ datagramìœ¼ë¡œ **ìº¡ìŠí™”**
3. receiving ì¸¡ì—ì„œ segmentë¥¼ **transport layer**ë¡œ ì „ë‹¬
4. ëª¨ë“  í˜¸ìŠ¤íŠ¸ì™€ routerì—ì„œ **network layer protocol** ì‹¤í–‰
5. routerê°€ ëª¨ë“  **IP datagram**ì˜ í—¤ë” í•„ë“œ ê²€ì‚¬

### Netwrokì˜ two key functions
---
#### 1. Routing
ğŸ“š**<span style="color: #008000"><span style="color: #008000">Routing</span>**: ì¶œë°œì§€ì—ì„œ ëª©ì ì§€ê¹Œì§€ì˜ **ê²½ë¡œë¥¼ ê²°ì •**í•˜ëŠ” ê³¼ì •
* ì—¬í–‰ì„ ê³„íší•  ë•Œ ì¶œë°œì§€ì—ì„œ ëª©ì ì§€ê¹Œì§€ì˜ ì „ì²´ ê²½ë¡œë¥¼ ê³„íší•˜ëŠ” ê²ƒê³¼ ê°™ìŒ

#### 2. Forwarding
ğŸ“š**<span style="color: #008000">Forwarding</span>**: ë¼ìš°í„°ê°€ **ì…ë ¥ í¬íŠ¸ì—ì„œ ì ì ˆí•œ ì¶œë ¥ í¬íŠ¸ë¡œ íŒ¨í‚·ì„ ì´ë™**ì‹œí‚¤ëŠ” ê³¼ì •
* ì—¬í–‰ ì¤‘ ê° êµì°¨ë¡œì—ì„œ ì–´ëŠ ë°©í–¥ìœ¼ë¡œ ê°ˆì§€ ê²°ì •í•˜ëŠ” ê²ƒê³¼ ê°™ìŒ

![alt text](../assets/img/Computer_Network/routing_forwarding.png)

* **Routing algorithm**ì„ í†µí•´ ìµœì ì˜ ê²½ë¡œë¡œ **forwarding table**ì„ ë§Œë“¦
* **forwarding table**ì„ í†µí•´ **output linkë¡œ íŒ¨í‚· ì „ì†¡**
  * í•˜ì§€ë§Œ ìœ ì‹¤ ê°€ëŠ¥ì„±ì€ ì¡´ì¬!

{:.prompt-warning}
> ì‹¤ì œ ì¸í„°ë„·ì—ëŠ” ì•½ 40ì–µ ê°œì˜ IP ì£¼ì†Œê°€ ì¡´ì¬ â†’ ë§Œì•½ ê°ê°ì˜ ëª©ì ì§€ ì£¼ì†Œë§ˆë‹¤ ê°œë³„ ì—”íŠ¸ë¦¬ë¥¼ ë§Œë“ ë‹¤ë©´ í¬ì›Œë”© í…Œì´ë¸”ì´ ë„ˆë¬´ ì»¤ì ¸ì„œ ë¹„íš¨ìœ¨ì !
>

* ê·¸ë˜ì„œ ê° ì—”íŠ¸ë¦¬ì— ì „ì²´ ì£¼ì†Œê°€ ì•„ë‹Œ **<span style="color: #008000">Address range</span>**ë¥¼ ì‚¬ìš©í•œë‹¤

### Address Range Aggregation
---
![alt text](../assets/img/Computer_Network/Address_Range_Aggregation.png)

* ê°œë³„ ì£¼ì†Œ ëŒ€ì‹  **ì£¼ì†Œ ë²”ìœ„**ë¥¼ ì‚¬ìš©
* **ì—¬ëŸ¬ ëª©ì ì§€ë¥¼ í•˜ë‚˜ì˜ entryë¡œ í†µí•©** â†’ table sizeë¥¼ ëŒ€í­ ê°ì†Œ

ìœ„ì˜ table ì˜ˆì‹œì—ì„œ ì—¬ëŸ¬ ì—”íŠ¸ë¦¬ì— ëª©ì ì§€ ì£¼ì†Œê°€ ë§¤ì¹­ë  ê²½ìš°ê°€ ì¡´ì¬í•¨

âœ…**ê°€ì¥ ê¸¸ê²Œ ë§¤ì¹­ë˜ëŠ” ì—”íŠ¸ë¦¬ë¥¼ ì°¾ì•„ì„œ ì„ íƒ**!  

* **<span style="color: #008000">Longest Prefix Matching</span>**
  * ëª©ì ì§€ ì£¼ì†Œì™€ ê° í…Œì´ë¸” ì—”íŠ¸ë¦¬ì˜ prefixë¥¼ ë¹„êµ
  * ì—¬ëŸ¬ ë§¤ì¹­ì´ ë°œê²¬ë˜ë©´ **longest prefix matching**ì„ ì„ íƒ
  * í•´ë‹¹í•˜ëŠ” ì¶œë ¥ ì¸í„°í˜ì´ìŠ¤ë¡œ íŒ¨í‚· ì „ì†¡

* **ì˜ˆì‹œ:**
* `DA: 11001000 00010111 00010110 10100001`
* ë§¤ì¹­ ê°€ëŠ¥í•œ entrys:
  * `11001000 00010111 00010*** ********` (21bits ë§¤ì¹­)
  * `11001000 00010111 00011*** ********` (20bits ë§¤ì¹­)
* 21bitsê°€ ë” ê¸¸ë¯€ë¡œ ì²« ë²ˆì§¸ ì—”íŠ¸ë¦¬ ì„ íƒ â†’ **interface 0**

## â­IP(Internet Protocol)
---
#### IP datagram format
![alt text](../assets/img/Computer_Network/IPdatagram.png)
> IP datagram format

1. **ê¸°ë³¸ ì •ë³´ í•„ë“œ**
* `ver`: IP protocol version (IPv4 = 4 / IPv6 = 6)
* `header length`: í—¤ë”ì˜ ê¸¸ì´(4bytes)
  * ë°ì´í„° í•œ ì¤„ì´ 32bits(4bytes)ì´ë¯€ë¡œ `5ì¤„ * 4bytes = 20bytes`ê°€ ê¸°ë³¸ IP header ê¸¸ì´
* `type of service`: IP data typeì„ í‘œì‹œ.
* `length`: ì „ì²´ ë°ì´í„°ì˜ ê¸¸ì´(bytes) = `header + data`

2. **ë¶„í• /ì¬ì¡°ë¦½ í•„ë“œ**
* `16-bit identifier`: ë¶„í• ëœ íŒ¨í‚·ë“¤ì˜ ì›ë³¸ ì‹ë³„ì
* `flags` : ë¶„í•  ì œì–´
* `fragment offset`: ë¶„í• ëœ ë°ì´í„°ì˜ ì›ë³¸ ìœ„ì¹˜

4. **ë„¤íŠ¸ì›Œí¬ ì œì–´ í•„ë“œ**
* `time to live(TTL)`: íŒ¨í‚· ìƒì¡´ ì‹œê°„(hop ìˆ˜). dataê°€ ë¼ìš°í„°ì—ì„œ ë¬´í•œíˆ ì¡´ì¬í•˜ëŠ” ê²ƒì„ ë°©ì§€
  * **hop**: ë¼ìš°í„°ë¥¼ í•˜ë‚˜ ê±´ë„ˆê°€ëŠ” í–‰ìœ„
  * ex: ì²˜ìŒì— 200ê°œì˜ hopì„ í• ë‹¹ â†’ ë°ì´í„°ê°€ ë¼ìš°í„°ë¥¼ ê±´ë„ë•Œ ë§ˆë‹¤ TTLí•„ë“œ ê°’ì´ ì¤„ì–´ë“¦ â†’ TTL=0ì´ ë˜ë©´ ë°ì´í„°ì˜ ìˆ˜ëª…ì´ ë‹¤í•œ ê²ƒìœ¼ë¡œ ê°„ì£¼ â†’ ë¼ìš°í„°ì—ì„œ í•´ë‹¹ ë°ì´í„°ë¥¼ ì œê±° â†’ í•´ë‹¹ ë°ì´í„°ê°€ ì¶œë°œí•œ ê³³ì— ì–´ë–¤ ë¼ìš°í„°ì—ì„œ ì œê±°ë˜ì—ˆë‹¤ê³  ì•Œë ¤ì¤Œ
* `upper layer`: upper layer(=Transport layer) protocol(TCP/UDP) ì‹ë³„
* `header checksum`: transport layerì—ì„œ ë°›ì€ ë°ì´í„°ì˜ header ì˜¤ë¥˜ ê²€ì¶œ

5. **ì£¼ì†Œ í•„ë“œ**
* ê°€ì¥ ì¤‘ìš”í•œ í•„ë“œ
* `32 bit source IP address`: ì¶œë°œì§€ IP ì£¼ì†Œ
* `32 bit destination IP address`: ëª©ì ì§€ IP ì£¼ì†Œ

* `option`: ì¶”ê°€ì ì¸ ì •ë³´ ì €ì¥(ì—†ì„ ìˆ˜ë„ ìˆìŒ)

ê° í•„ë“œë³„ ìì„¸í•œê±´ ì°¨ì°¨ ì•Œì•„ë³´ì

**IP dataì—ëŠ” TCP or UDPë¡œ ë¶€í„° ë°›ì€ segmentê°€ ìˆê³ ** ê±°ê¸°ì— ë„¤íŠ¸ì›Œí¬ layer headerê°€ ë§ë¶™ì—¬ì§„ë‹¤
ê·¸ ë•Œë¬¸ì— ë„¤íŠ¸ì›Œí¬ íŒ¨í‚·ì—ëŠ” ì˜¤ë²„í—¤ë“œê°€ ì¡´ì¬
![alt text](../assets/img/Computer_Network/IPdatagram_overhead.png)

* **Total overhead**: **40bytes**(`IP 20bytes + TCP 20bytes`) + **app msg**

ìœ„ì—ì„œ ë³¸ IP datagram formatì—ì„œ ê°€ì¥ ì¤‘ìš”í•œ source/destination IP addressì— ëŒ€í•´ ì•Œì•„ë³´ì

### IPv4 addressing
---
ğŸ“š**<span style="color: #008000">IP address</span>**: **32-bit unique number**ë¡œ, **í˜¸ìŠ¤íŠ¸ë‚˜ ë¼ìš°í„°ì˜ <span style="color: #008000">interface</span>ë¥¼ ì‹ë³„**

* dotted-quad notationìœ¼ë¡œ í‘œí˜„ë¨
![alt text](../assets/img/Computer_Network/ipaddr.png)
> `12.34.158.5`

ê·¸ëŸ¼ ì–´ë–¤ ë°©ì‹ìœ¼ë¡œ IP ì£¼ì†Œë¥¼ ë°°ì •í• ê¹Œ??

#### Grouping Related Hosts
---
![alt text](../assets/img/Computer_Network/Grouping_Related_Hosts.png)
> ì¸í„°ë„·ì€ ê°œë³„ í˜¸ìŠ¤íŠ¸ê°€ ì•„ë‹Œ ë„¤íŠ¸ì›Œí¬ë“¤ì´ ì—°ê²°ë˜ì–´ ìˆëŠ” ëª¨ìŠµì´ë‹¤

âŒ**í˜¸ìŠ¤íŠ¸ë§ˆë‹¤ ì„ì˜ì˜ ì£¼ì†Œë¥¼ í• ë‹¹í•œ ê²½ìš°**
![alt text](../assets/img/Computer_Network/Scalability_Challenge.png)

* ë¼ìš°í„°ê°€ ëª¨ë“  ê°œë³„ í˜¸ìŠ¤íŠ¸ ì •ë³´ ì €ì¥ í•„ìš”
* forwarding tableì˜ í¬ê¸°ê°€ ì—„ì²­ë‚˜ê²Œ ì»¤ì§!(ì „ ì„¸ê³„ í˜¸ìŠ¤íŠ¸ì˜ ìˆ˜)

{:.prompt-tip}
> ì£¼ì†Œë¥¼ ê³„ì¸µêµ¬ì¡°ë¡œ ë§Œë“¤ì!!
>

![alt text](../assets/img/Computer_Network/Hierarchical_Addressing.png)

* IP addressë¥¼ **ë„¤íŠ¸ì›Œí¬ ë¶€ë¶„ + í˜¸ìŠ¤íŠ¸ ë¶€ë¶„**ìœ¼ë¡œ ë¶„í• 
* ê°™ì€ **subnet**ì˜ í˜¸ìŠ¤íŠ¸ë“¤ì„ ê·¸ë£¹í™”
* ë¼ìš°í„°ëŠ” ë„¤íŠ¸ì›Œí¬ ë‹¨ìœ„ë¡œë§Œ ê²½ë¡œë¥¼ ê´€ë¦¬

##### Subnet Mask
![alt text](../assets/img/Computer_Network/Subnet_Mask.png)

ğŸ“š**Subnet mask**: IP ì£¼ì†Œì—ì„œ **ë„¤íŠ¸ì›Œí¬ ë¶€ë¶„ê³¼ í˜¸ìŠ¤íŠ¸ ë¶€ë¶„ì„ êµ¬ë¶„í•˜ê¸° ìœ„í•œ 32bit ê°’**

* IP ì£¼ì†Œì™€ Subnet maskë¥¼ ì¤€ë¹„í•˜ê³  AND ì—°ì‚°ì„ ìˆ˜í–‰í•´ì„œ ë„¤íŠ¸ì›Œí¬ ì£¼ì†Œë¥¼ ì–»ì–´ëƒ„

#### Scalability Improved
---
ì´ì œ ê°œë³„ í˜¸ìŠ¤íŠ¸ë§ˆë‹¤ IPì£¼ì†Œë¥¼ ì£¼ê³  ê´€ë¦¬í•  í•„ìš” ì—†ì´ ë„¤íŠ¸ì›Œí¬ ë‹¨ìœ„ë¡œ ê´€ë¦¬ê°€ ê°€ëŠ¥í•´ì¡Œë‹¤!

![alt text](../assets/img/Computer_Network/Scalability_Improved.png)
> ë§Œì•½ `5.6.7.213` í˜¸ìŠ¤íŠ¸ ì¶”ê°€ ì‹œ ê¸°ì¡´ `5.6.7.0/24` ê²½ë¡œë¥¼ í™œìš©í•˜ë©´ ë¨  
> ì¦‰, forwading table ì—”íŠ¸ë¦¬ ì¶”ê°€(ë¼ìš°í„° ì—…ë°ì´íŠ¸) ë¶ˆí•„ìš”