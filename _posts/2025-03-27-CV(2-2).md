---
title: "[CV] Computer Vision(2-2): Image Processing - Geometric Transformation"

categories: [CV, Computer Vision]
tags:
  - [CV, Computer Vision, python]
toc: true
toc_sticky: true
use_math: true

date: 2025-03-27
last_modified_at: 2025-03-27
image: 
---
ğŸ‘“Computer Vision ì •ë¦¬

## Geometric Transformation
---
### Geometric ê°œë… ì •ë¦¬
---

{:.prompt-warning}
> ì£¼ì˜: ì´ ìŠ¬ë¼ì´ë“œì— ë‚˜ì™€ìˆëŠ” ì ë“¤ì˜ ì¢Œí‘œë“¤ì€ (x-ì¢Œí‘œ,y-ì¢Œí‘œ)ë¡œ í‘œê¸°ë˜ì–´ìˆìŒ  
> ì¦‰, computer visonì—ì„œëŠ” (y,x)ë¡œ ë°”ê¿”ì•¼í•¨  

* **Scalar**: real number (only magnitude), (e.g., distance)
* **Vector**: direction + magnitude
* **Point**: a location in space

![alt text](../assets/img/CV/scalar_vector.png)

* ë²¡í„°ì˜ í•©, ê³± ë“±ë“±
* ë²¡í„° + ë²¡í„° = ë²¡í„° / ë²¡í„° * ìŠ¤ì¹¼ë¼ = ë²¡í„°

#### Parametric Form & Affine Sum
![alt text](../assets/img/CV/Line.png)

#### Dot Product(ë‚´ì )
![alt text](../assets/img/CV/Dot_Product.png)
> $\vec{a}\cdot\vec{b} = 0$ â†’ ë‘ ë²¡í„° ìˆ˜ì§

#### Cross Product(ì™¸ì )
![alt text](../assets/img/CV/Cross_Product.png)
> ë°©í–¥: $\vec{a}, \vec{b}$ì— ëª¨ë‘ ìˆ˜ì§, **ì˜¤ë¥¸ì† ë²•ì¹™ ë”°ë¦„**  
> ê²°ê³¼ ë²¡í„° í¬ê¸°(axb): **í‰í–‰ì‚¬ë³€í˜• ë„“ì´**

## 2D Geometric Transformation
---
![alt text](../assets/img/CV/2D_point.png)
> 2ì°¨ì› í¬ì¸íŠ¸ëŠ” $(x,y)$ or $x=\begin{bmatrix}x \\\\ y\end{bmatrix}$ë¡œ í‘œí˜„ê°€ëŠ¥  

* **<span style="color: #008000">linear transformation</span>**: ì–´ë–¤ í–‰ë ¬ì„ ì´ìš©í•´ ë²¡í„°ë¥¼ ë³€í™˜í•˜ëŠ” ê²ƒ

![alt text](../assets/img/CV/2D_Linear_transformation.png)
> ì ì—ì„œ ì ìœ¼ë¡œ ê°€ëŠ” mappingì„ í‘œí˜„í•˜ê¸° ìœ„í•´ ì„ í˜• ë³€í™˜ì„ ì‚¬ìš©  
> 2ì°¨ì›ì˜ ê²½ìš° 2x2ì„ ì´ìš©í•´ ë³€í™˜   
> ì„ í˜• ë³€í™˜ ì¡°ê±´:  
> > $L(a+b) = L(a) + L(b)$  
> > $L(sa) = sL(a)$

### 2D Scaling
---
* **<span style="color: #008000">Scaling</span>**: changes length (and direction)

![alt text](../assets/img/CV/Scaling.png)
> ëŒ€ê°ì„  ë°©í–¥ìœ¼ë¡œ ë³€ê²½í•˜ê³ ì í•˜ëŠ” ê°’ì„ ì“°ë©´ ë¨

![alt text](../assets/img/CV/Scaling_ex.png)
![alt text](../assets/img/CV/Scaling_ex1.png)
> $s_x = s_y$: ê· ì¼ ìŠ¤ì¼€ì¼ë§ (uniform scaling) â†’ ëª¨ì–‘ì€ ê·¸ëŒ€ë¡œ í¬ê¸°ë§Œ ë³€í•¨  
> $s_x \neq s_y$: ë¹„ê· ì¼ ìŠ¤ì¼€ì¼ë§ (non-uniform) â†’ í˜•íƒœê°€ ì°Œê·¸ëŸ¬ì§ˆ ìˆ˜ ìˆìŒ

### 2D Rotation
---
* **<span style="color: #008000">Rotation</span>**: ë²¡í„°ë¥¼ ê°ë„ $\theta$ë§Œí¼ **ë°˜ì‹œê³„ ë°©í–¥ìœ¼ë¡œ íšŒì „**ì‹œí‚¤ëŠ” ë³€í™˜

âœ… ë²¡í„° $a=(x_a, y_a)$ëŠ” ë‹¤ìŒ ë‘ ê°€ì§€ ë°©ì‹ìœ¼ë¡œ í‘œí˜„ ê°€ëŠ¥:  
  * ì§êµ ì¢Œí‘œê³„(cartesian coordinates): $(x_a, y_a)$
  * ê·¹ì¢Œí‘œê³„(polar coordinates): $(r\cos\alpha, r\sin\alpha)$
    * $r$ì€ ë²¡í„°ì˜ ê¸¸ì´: $r = \sqrt{(x_a^2 + y_a^2)}$
    * $\alpha$ëŠ” xì¶•ê³¼ ë²¡í„°ê°€ ì´ë£¨ëŠ” ê°ë„

ë²¡í„° aë¥¼ ê°ë„ $\theta$ë§Œí¼ ë°˜ì‹œê³„ ë°©í–¥ìœ¼ë¡œ íšŒì „ì‹œí‚¨ ë²¡í„° bëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤:  
* $x_b = r\cos(Î± + \theta) = r\cos Î±\cos\theta - r\sin Î±\sin\theta$
* $y_b = r\sin(Î± + \theta) = r\sin Î±\cos\theta + r\cos Î±\sin\theta$
* ì´ë•Œ $r\cos\alpha = x_a$ì™€ $r\sin\alpha = y_a$ì´ë¯€ë¡œ
  * $x_b = x_a\cos\theta - y_a\sin\theta$
  * $y_b = y_a\cos\theta + x_a\sin\theta$

![alt text](../assets/img/CV/2D_Rotation.png)

![alt text](../assets/img/CV/2D_Rotation_ex.png)
> (xb, yb)ë¥¼ `matrix`ë¡œ ë‚˜íƒ€ë‚´ë©´ ì‚¬ì§„ê³¼ ê°™ìŒ
> 2D rotationë„ 2x2ë¡œ ê³„ì‚°ì´ ë˜ê¸° ë•Œë¬¸ì— **linear transformation** ì´ë‹¤.

âœ… **Rotation Properties**  
  * **Orthogonal matrix(ì§êµ í–‰ë ¬)**: Two columns (rows) are orthogonal(ì„œë¡œ ë‚´ì ‘ì„ í–ˆì„ ë•Œ 0ì´ ë ë•Œ)
    * (cosğœƒ,sinğœƒ)âˆ™âˆ’(sinğœƒ,cosğœƒ)=0
  * **inverse matrix(ì—­í–‰ë ¬)**
    * ![alt text](../assets/img/CV/inverse_matrix.png)
      > Rì˜ ì—­í–‰ë ¬ì€ (-theta) ë¥¼ í•´ì£¼ëŠ”ë° ê·¸ê²Œ **ì „ì¹˜í–‰ë ¬**ê³¼ ê°™ë‹¤.
      > ì¦‰, ì—­í–‰ë ¬ì„ êµ¬í•˜ê¸° ìœ„í•´ì„œ ê·¸ëƒ¥ ì „ì¹˜í–‰ë ¬($R^T$)ì„ ì‚¬ìš©í•˜ë©´ ë˜ì„œ ìœ ìš©í•¨

### 2D Shear
---
* **<span style="color: #008000">Shear</span>**: ë¬¼ì²´ë¥¼ í•œ ë°©í–¥ìœ¼ë¡œ "ë°€ì–´ë‚´ëŠ”" ë³€í™˜, í‰í–‰ì‚¬ë³€í˜• ëª¨í˜•ìœ¼ë¡œ ë³€í™˜ëœë‹¤.

**X, Y ë°©í–¥ shearëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤:**  
* `shear_x(s)` = $ \begin{bmatrix} 1 & s \\\\ 0 & 1 \end{bmatrix}$
* `shear_y(s)` = $ \begin{bmatrix} 1 & 0 \\\\ s & 1 \end{bmatrix}$
> shear_x(s) ë³€í™˜ì´ ì  (x,y)ì— ì ìš©ë˜ë©´ $x' = x+sy, y'=y$
> ì¦‰ yì¢Œí‘œëŠ” ë³€í•˜ì§€ ì•Šê³ , **xì¢Œí‘œëŠ” yì¢Œí‘œì— ë¹„ë¡€í•˜ì—¬ ì´ë™**

![alt text](../assets/img/CV/2D_Shear.png)
> xë°©í–¥ìœ¼ë¡œ shearingí• ë•Œì˜ ì˜ˆì‹œ

![alt text](../assets/img/CV/2D_Sheary.png)
> yë°©í–¥ìœ¼ë¡œ shearingí• ë•Œì˜ ì˜ˆì‹œ

### 2D Reflection
---
* **<span style="color: #008000">Reflection</span>**: ì¢Œí‘œ ì¶•ì„ ê¸°ì¤€ìœ¼ë¡œ ë¬¼ì²´ë¥¼ "ë’¤ì§‘ëŠ”" ë³€í™˜

**X, Y ë°©í–¥ ReflectionëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤:**  
* `reflect_x` =  $ \begin{bmatrix} 1 & 0 \\\\ 0 & -1 \end{bmatrix}$
* `reflect_y` =  $ \begin{bmatrix} -1 & 0 \\\\ 0 & 1 \end{bmatrix}$
> reflect_x ë³€í™˜ì´ ì  (x,y)ì— ì ìš©ë˜ë©´ $x' = x, y'=-y$  
> ì¦‰, **yì¢Œí‘œë§Œ ë¶€í˜¸ê°€ ë°”ë€ë‹¤**

![alt text](../assets/img/CV/2D_Reflection.png)
![alt text](../assets/img/CV/2D_Reflectiony.png)

### 2D Translation
---
* **<span style="color: #008000">Translation</span>**: ë¬¼ì²´ì˜ **ëª¨ë“  ì ì„ ë™ì¼í•œ ê±°ë¦¬ì™€ ë°©í–¥ìœ¼ë¡œ ì´ë™ì‹œí‚¤ëŠ” ë³€í™˜**

ì´ë™ ë³€í™˜ ìˆ˜ì‹:  
* $x' = x + x_t$
* $y' = y + y_t$
> $(x_t,y_t)$ëŠ” ì´ë™ ë²¡í„°

![alt text](../assets/img/CV/2D_Translation.png)

{:.prompt-warning}
> **ì¼ë°˜ì ì¸ 2x2í–‰ë ¬ë¡œëŠ” Translationì„ ë‚˜íƒ€ë‚¼ ìˆ˜ ì—†ë‹¤!**

ê·¸ëŸ¼ ì–´ë–»ê²Œ ê³„ì‚°í•´ì•¼í•˜ë‚˜? 
â†’ ê·¸ë˜ì„œ ë‚˜ì˜¨ ì´ë¡ ì´ **<span style="color: #008000">Homogeneous Coordinate</span>**

### Homogeneous Coordinate
---
**<span style="color: #008000">Homogeneous Coordinate(ë™ì°¨ ì¢Œí‘œê³„)</span>**: ë™ì°¨ ì¢Œí‘œê³„ëŠ” ê¸°ì¡´ì˜ ì¢Œí‘œê³„ë¥¼ í™•ì •í•˜ì—¬, ì ,ì„ ,ë©´ ë“±ì„ ì¼ê´€ëœ ë°©ì‹ìœ¼ë¡œ í‘œí˜„í•˜ê³  ë³€í™˜í•  ìˆ˜ ìˆê²Œ í•œë‹¤.

* 2ì°¨ì›ì—ì„œ ì  $x = (x,y)$ëŠ” ë™ì°¨ ì¢Œí‘œê³„ì—ì„œ ë‹¤ìŒê³¼ ê°™ë‹¤.

![alt text](../assets/img/CV/Homogeneous.png)
> $\tilde{x}$ëŠ” **ë™ì°¨ ì¢Œí‘œê³„ì—ì„œì˜ ì **  
> $\bar{x} = (x,y,1)$ì€ **ì¦ê°• ë²¡í„°(augmented vector)**  
> $\tilde{w} \neq {0}$ì¸ ëª¨ë“  $(\tilde{x},\tilde{y},\tilde{w})$ëŠ” 2D ì  $\tilde{x}/\tilde{w}, \tilde{y}/\tilde{w}$ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤

{:.prompt-tip}
> ì¦‰, ë™ì°¨ ì¢Œí‘œê³„ì—ì„œëŠ” (2,3,1), (4,6,2), (6,9,3) **ëª¨ë‘ 2D ê³µê°„ì—ì„œ ê°™ì€ ì  (2,3)ì„ ë‚˜íƒ€ë‚¸ë‹¤!**

* ë§Œì•½ $\tilde{x}$ = (x,y,0)(=$\tilde{w}$=0)ì´ë©´ ì´ pointëŠ” **<span style="color: #008000">ideal point</span>** ë˜ëŠ” **point at infinity**ë¼ê³  ë¶ˆë¦°ë‹¤
  * ideal pointëŠ” ë°©í–¥ì„ ë‚˜íƒ€ë‚´ëŠ”ë° ìœ ìš©í•˜ë‹¤
![alt text](../assets/img/CV/Homogeneous_ex.png)

#### 2D Lines
---
**Homogeneous Corrdinateì—ì„œ <span style="color: #008000">2D line</span>:** $\tilde{l} = (a,b,c)$
* **ì§ì„ ì˜ ë°©ì •ì‹**: $\bar{x}\cdot\tilde{l} = ax + by + c = 0$
* $\tilde{l}$ì„ ì •ê·œí™”:
  * $l = (\hat{n}x, \hat{n}y, d) = (\hat{**n**}, d), \parallel\hat{**n**}\parallel = 1$
> $\hat{**n**}$: ì§ì„ ì— ìˆ˜ì§ì¸ ë‹¨ìœ„ **normal vector**  
> $\hat{**n**} = (\hat{n}x, \hat{n}y) = (\cos\theta, \sin\theta)$  
> d: ì›ì ì—ì„œ ì§ì„ ê¹Œì§€ ê±°ë¦¬  
> $(\theta, d)$: ê·¹ì¢Œí‘œê³„

* $l$ = (0,0,1): **ë¬´í•œëŒ€ì— ìˆëŠ” ì§ì„ **ìœ¼ë¡œ, ëª¨ë“  ë¬´í•œëŒ€ ì ë“¤ì„ í¬í•¨í•¨

![alt text](../assets/img/CV/2D_Lines.png)

### Homogeneous Matrix
---
* ë™ì°¨ ì¢Œí‘œê³„ì—ì„œì˜ 2D ë³€í™˜ì€ ë‹¤ìŒê³¼ ê°™ì´ ë³€í•œë‹¤

![alt text](../assets/img/CV/Homogeneous_Matrix.png)
> ìˆœì„œëŒ€ë¡œ `Rotation`, `scale`, `translation` ë³€í™˜
* ì—¬ëŸ¬ ë³€í™˜ì„ ì¡°í•©í•˜ë ¤ë©´ ê° ë³€í™˜ í–‰ë ¬ì„ ê³±í•˜ê¸°ë§Œ í•˜ë©´ ëœë‹¤!
{:.prompt-tip}
> í–‰ë ¬ì„ ê³±í•  ë•ŒëŠ” ì ìš©í•œ í–‰ë ¬ì˜ ë°˜ëŒ€ ìˆœì„œë¡œ ê³±í•´ì•¼í•œë‹¤!

* **ë³µí•© ë³€í™˜ ì˜ˆì‹œ**:

![alt text](../assets/img/CV/transformationex.png)
![alt text](../assets/img/CV/transformationex1.png)
![alt text](../assets/img/CV/transformationex2.png)

ì˜ˆì‹œì—ì„œëŠ” ì›ì ìœ¼ë¡œ ì´ë™ â†’ Rotation ë³€í™˜ â†’ ë‹¤ì‹œ ì›ë˜ì˜ ìœ„ì¹˜ë¡œ ì´ë™ì´ë¯€ë¡œ

```
T_final = T_translation(ì›ë˜ ìœ„ì¹˜ë¡œ ì´ë™) Ã— T_rotation x T_translation(ì›ì  ì´ë™)
```

ë‹¤ì‹œ CVê´€ì ìœ¼ë¡œ ëŒì•„ì™€ì„œ **(y,x) ì¢Œí‘œê³„ì—ì„œì˜ Homogeneous Matrix**ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤
![alt text](../assets/img/CV/Homogeneous_Matrixr.png)

* (y,x)ì¢Œí‘œê³„ì—ì„œì˜ ë³µí•© ì—°ì‚° ì˜ˆì‹œ:
![alt text](../assets/img/CV/Homogeneous_Matrixrex.png)

* 2D Transformationì˜ ì¢…ë¥˜ì™€ íŠ¹ì„±:
![alt text](../assets/img/CV/Homogeneous_Matrixr1.png)  
> DoFëŠ” ììœ ë„(ìš°ë¦¬ê°€ ë³€í™˜í•˜ëŠ” ì–‘)  
> Similarityì—ì„œ DoF: 4(ìŠ¤ì¼€ì¼ 1ê°œ, íšŒì „ 1ê°œ, ì´ë™ 2ê°œ)  
> ì „ì¹˜í–‰ë ¬ Tì¸ ì´ìœ ëŠ” ì‚¬ì§„ì€ (x,y)ì´ê¸° ë•Œë¬¸

ê·¸ëŸ¼ ì´ë¯¸ì§€ì— Geometric Transformationì€ ì–´ë–»ê²Œ ì ìš©ì´ ë˜ëŠ”ê°€?
#### Geometric Transformation ì ìš©
![alt text](../assets/img/CV/Geometric_Transformationa.png)
1. **<span style="color: #008000">Foward warping</span>:**
  * ì†ŒìŠ¤ ì´ë¯¸ì§€ì˜ **ê° í”½ì…€ì„ ë³€í™˜í•˜ì—¬ ëŒ€ìƒ ì´ë¯¸ì§€ì˜ ìœ„ì¹˜ë¡œ ë§¤í•‘**
  * ë¬¸ì œì : 
    * **ì•¨ë¦¬ì–´ì‹±(aliasing) ì•„í‹°íŒ©íŠ¸ê°€ ë°œìƒ**í•  ìˆ˜ ìˆë‹¤.
    * **ì†ŒìŠ¤ ì´ë¯¸ì§€ì˜ í”½ì…€ì´ ì •í™•íˆ ëŒ€ìƒ ì´ë¯¸ì§€ì˜ í”½ì…€ ê²©ìì— ë§ì§€ ì•Šì„ ìˆ˜ ìˆì–´ ë¹ˆ ê³µê°„(í™€)ì´ ìƒê¸¸ ìˆ˜ ìˆë‹¤**.
2. **<span style="color: #008000">Inverse warping</span>**:
  * **ëŒ€ìƒ ì´ë¯¸ì§€ì˜ ê° í”½ì…€ ìœ„ì¹˜ì— ëŒ€í•´, ì†ŒìŠ¤ ì´ë¯¸ì§€ì—ì„œ ê°’ì„ ê°€ì ¸ì˜¨ë‹¤**
  * í•˜ì§€ë§Œ ì—¬ê¸°ì„œë„ ë‹¤ë¥¸ ë‘ ê°œì˜ ëŒ€ìƒ í”½ì…€ì´ ê°™ì€ ì†ŒìŠ¤ í”½ì…€ì„ ì°¸ì¡°í•˜ë¯€ë¡œ ì•¨ë¦¬ì–´ì‹± ë°œìƒ

ì•¨ë¦¬ì–´ì‹±ì„ í•´ê²°í•˜ê¸° ìœ„í•´ **<span style="color: #008000">Interpolation</span>**ìœ¼ë¡œ ë³´ì™„í•œë‹¤

#### Interpolation
---
**<span style="color: #008000">Interpolation</span>**: ì•Œë ¤ì§„ ë°ì´í„° í¬ì¸íŠ¸ ì‚¬ì´ì˜ **ì¤‘ê°„ ê°’ì„ ì¶”ì •**í•˜ëŠ” ë°©ë²•

![alt text](../assets/img/CV/Interpolation.png)
> 1D Linear Interpolationê³¼ 2D Bilinear Interpolation

* **1D Linear Interpolation**: **ë‘ ê°œì˜ ì•Œë ¤ì§„ ë°ì´í„° í¬ì¸íŠ¸ ì‚¬ì´ì˜ ê°’ì„ ì§ì„ ìœ¼ë¡œ ê·¼ì‚¬í•˜ì—¬ ì¶”ì •**
  * 
* **2D Bilinear Interpolation**: ì•Œë ¤ì§„ **ë„¤ ê°œì˜ ê²©ìì (grid points) ì‚¬ì´ì˜ ê°’ì„ ì¶”ì •**

* lecture 5ì˜ Edge Thinningì€ ì‹œí—˜ X