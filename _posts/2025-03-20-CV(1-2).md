---
title: "[CV] Computer Vision(1-2): Image Processing - Neighborhood operator"

categories: [CV, Computer Vision]
tags:
  - [CV, Computer Vision, python]
toc: true
toc_sticky: true
use_math: true

date: 2025-03-20
last_modified_at: 2025-03-20
image: 
---
ğŸ‘“Computer Vision ì •ë¦¬

## Neighborhood operator
---
* **<span style="color: #008000">Neighborhood operator</span>**: pixel value computed using a collection of pixel values in a **small neighborhood**
* **Linear filter**: a pixelâ€™s value is a <u>weighted sum</u> of pixel values within a small neighborhood

* Correlation and convolution operators
  * ![alt text](../assets/img/CV/Correlation_and_convolution.png)

#### 1D Example
![alt text](../assets/img/CV/1D_Example.png)
> ì´ë¯¸ì§€ fì— í•„í„° uë¥¼ ì ìš©í•¨  
> Correlation: ê·¸ëŒ€ë¡œ ê³±í•´ì„œ ë”í•¨  
> Convolution: í•„í„°ë¥¼ ë’¤ì§‘ì–´ì„œ ê³±í•¨

#### 2D Exmaple
![alt text](../assets/img/CV/2D_Example.png)
> Convolution: í•„í„°ë¥¼ ë’¤ì§‘ìŒ â†’ **ì›ë˜ ì…ë ¥ê³¼ ê°™ì€ ëª¨ì–‘ ì¶œë ¥**  
> Correlation: í•„í„°ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš© â†’ **ì¶œë ¥ì—ì„œ í•„í„°ê°€ ë°˜ì˜ë˜ì–´ ë³´ì„**

### Properties of Convolution(Correlation)
---
`Correlation` and `convolution`ì€ **linear shift Invariantë¥¼ ê³µí†µ ì„±ì§ˆ**ë¡œ ê°€ì§„ë‹¤

* **<span style="color: #008000">LSI(Linear Shift Invariant)</span>**: ì„ í˜• & ì´ë™ ë¶ˆë³€
  * **linearity**:
  * $$u(f_0â€‹+f1_â€‹)=uf_0â€‹+uf_1$$
  * **shift-invariance(ì´ë™ ë¶ˆë³€ì„±)**:
  * ì…ë ¥ ì´ë™í•˜ë©´ ì¶œë ¥ë„ ë˜‘ê°™ì´ ì´ë™í•¨

![alt text](../assets/img/CV/LSI.png)
> ìˆ˜ì‹ í˜•íƒœ
>The shift invariance principle: **í•œ í”½ì…€ì”© ì ìš©í•œ ê²½ìš°ë‚˜ ì „ì²´ì ìœ¼ë¡œ ì ìš©í•œ ê²½ìš°ì˜ í”½ì…€ì´ ê°™ë‹¤**

* Correlation and convolution can be written as a **matrix-vector multiplication: g = Uf**

![alt text](../assets/img/CV/matrix-vector.png)
> 1ì°¨ì› 5pixel convolution ê²½ìš°ëŠ” 5 by 5 í–‰ë ¬ë¡œ í‘œí˜„ ê°€ëŠ¥

### Separable Filtering
---
* 2ì°¨ì›ì¼ ê²½ìš° $K^2$ operations per pixelì„ í•˜ê²Œ ëœë‹¤
* ì¢€ ë” íš¨ìœ¨ì ìœ¼ë¡œ ê³„ì‚°í•  ìˆ˜ ìˆë‚˜?
* filterì˜ shapeì„ (MxN) matricsì²˜ëŸ¼ í‘œí˜„í•  ìˆ˜ ìˆë‹¤ â†’ ê·¸ê±¸ `(mx1)`,`(1xn)` ìœ¼ë¡œ **í–‰ë ¬ì„ seperate**í•´ì„œ ê°ê° `K operation`ì„ í•˜ë©´ ëœë‹¤(2K) 
  * í–‰ë ¬ì„ seperateí•œë‹¤ëŠ” ì˜ë¯¸ëŠ” 2ê°œì˜ 1D í•„í„°ë¡œ ë¶„í•´í•œë‹¤ëŠ” ëœ»

![alt text](../assets/img/CV/2D_matrix-vector.png)
* **Box filter(moving average filter)**: **averages the pixels in a K x K window**
* **Bilinear filter(Bartlett filter)**: **smooths image** with a piecewise â€œtentâ€ function
  * ì¤‘ê°„ì— í° ê°€ì¤‘ì¹˜ë¥¼ ì£¼ê³  ì‹¶ì„ ë•Œ ì‚¬ìš©
* **Gaussian filter**: **made by convolving the linear tent function** with itself(ì¤‘ì‹¬ ê°•ì¡°, ë…¸ì´ì¦ˆ ì œê±°)
  * ì¤‘ê°„ì— ê°€ì¥ í° ê°€ì¤‘ì¹˜ë¥¼ ì£¼ê³  ì£¼ë³€ìœ¼ë¡œ ê°ˆìˆ˜ë¡ ì‘ê²Œ ì ìš©
* **Sobel filter**: simple 3x3 **edge extractor**(combination of horizontal central difference and a vertical tent filter)
  * 1~3ë²ˆì§¸ëŠ” noiseë¥¼ ì—†ì• ê¸° ìœ„í•œ filterë¼ë©´, sobelì€ ê·¸ë¦¼ì—ì„œ ì—£ì§€(feature)ë¥¼ ê²€ì¶œí•œë‹¤.
  * `edge extractor`: edgeì˜ ê°’ì´ ë³€í•´ì„œ edgeê°€ ë³€í•¨, ì˜ˆì‹œì—ì„œëŠ” ì˜¤ë¥¸ìª½ì—ì„œ ì™¼ìª½ì„ ë¹¼ì¤€ë‹¤.
* **Simple corner detector**: look forsimultaneous **horizontal/vertical** second derivatives (+diagonal edges)
  * ìˆ˜ì§, ìˆ˜í‰ì˜ ë³€í™”ë¥¼ filterí•¨

![alt text](../assets/img/CV/EX_Linear_filtering.png)

### Summed Area Table(Integral Image,ì ë¶„ ì˜ìƒ)
---
> ë„“ì€ ì‚¬ê°í˜• ì˜ì—­ì˜ í•©ì„ ë¹ ë¥´ê²Œ êµ¬í•˜ëŠ” ê¸°ìˆ 

ê°™ì€ ì´ë¯¸ì§€ì— ë‹¤ë¥¸ í¬ê¸°ì˜ box fliterë¥¼ ì ìš©í•´ì•¼í•˜ëŠ” ê²½ìš°ì— **ì ë¶„ ì˜ìƒì„** ì‚¬ìš©í•˜ê²Œ ëœë‹¤
* ì›ë˜ ë°©ì‹: MÃ—M ì˜ì—­ì˜ í•©ì„ êµ¬í•˜ë ¤ë©´ $M^2$ë²ˆ ë§ì…ˆ í•„ìš”
* **<span style="color: #008000">Summed Area Table</span>**ì„ ì‚¬ìš©í•˜ë©´ í•­ìƒ 4ë²ˆë§Œì— í•© ê³„ì‚° ê°€ëŠ¥
  * ë¹ ë¥¸ `Box Filtering`êµ¬í˜„ ê°€ëŠ¥

![alt text](../assets/img/CV/Summed_table.png)
> ëˆ„ì í•©ì„ êµ¬í•˜ëŠ” ì í™”ì‹  
> ì™¼ìª½ë¶€í„° êµ¬í•˜ê³  (2,2)ì˜ `5`ë¥¼ ê³„ì‚°í•˜ë ¤ë©´ `(3+2)+(3+1)-3+5 = 11` ì´ ëœë‹¤.

![alt text](../assets/img/CV/3x3filter.png)
> ê°€ìš´ë°ì— 3x3 box filterë¥¼ ì ìš©í•˜ë ¤ë©´ `48 - 13 - 14 + 3` ì˜ ê°’ì´ ëœë‹¤. 
> -13ì„ í•˜ë©´ ì™¼ìª½ ì„¸ë¡œ 3,1,5,4ê°€ ë‚ ë¼ê°€ëŠ” ì‹

### Non-Linear Filtering
---
* Non-linear filters perform better in some applications (E.g. **Edge-preserving** filtering, removing shot noises)

![alt text](../assets/img/CV/Non_linear.png)
> Gaussian Filter(linear): ë…¸ì´ì¦ˆëŠ” ì¤„ì§€ë§Œ ê²½ê³„ë„ íë ¤ì§  
> Median Filter(non-linear): ë…¸ì´ì¦ˆëŠ” ì‚¬ë¼ì§€ê³  **ê²½ê³„ëŠ” ì„ ëª…í•¨**

#### Median filter
**<span style="color: #008000">Median filter</span>**: **selects the median value** from each pixelâ€™s neighborhood
  * Can be implemented via linear-time algorithm(ì¤„ì„¸ìš°ê¸°)
  * Robust to removing shot noises while preserving edges

* ì˜ˆì‹œ:

```csharp
3x3 ìœˆë„ìš°:
[1 2 1]
[2 4 8]
[3 5 7]

â†’ ì •ë ¬: [1,1,2,2,3,4,5,7,8] â†’ ì¤‘ê°„ê°’ = 4
```
â†’ `salt-pepper` ì²˜ëŸ¼ **í™• íŠ€ëŠ” í˜„ìƒì„ ë°°ì œ**í•  ìˆ˜ ìˆìŒ

#### Bilateral filter
**<span style="color: #008000">Bilateral filter</span>**: reject pixels whose values **differ too much from the central pixel value**(**in a soft way**)
* ê°€ì¤‘ì¹˜ë¥¼ ì¤‘ì•™ (í”½ì…€ì—ì„œì˜ ê±°ë¦¬ + ìƒ‰ìƒ ê°’)ì— ëŒ€í•´ì„œ ì ìš©í•´ì„œ êµ¬í•¨

* ![alt text](../assets/img/CV/Bilateral_filter.png)
  * ê°€ê¹Œìš°ë©´ì„œ â†’ ê°’ì´ ë¹„ìŠ·í•œ â†’ í”½ì…€ë§Œ ì‚´ì‚´ ì„ëŠ”ë‹¤
  * ê²½ê³„ëŠ” ì§€í‚¤ê³ , ë…¸ì´ì¦ˆë§Œ ì œê±°í•  ìˆ˜ ìˆìŒ