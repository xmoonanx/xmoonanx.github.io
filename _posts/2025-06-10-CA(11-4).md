---
title: "[CA] Chapter 11: Exploiting Memory Hierarchy(3-2) - cache for real world"

categories: [CS, Computer Architecture, CA, Assembly language]
tags:
  - [CS, c, cpp, Computer Architecture, CA, Assembly language, binary code]
toc: true
toc_sticky: true

date: 2025-06-10
last_modified_at: 2025-06-10
---
âš™ **Computer Architecture ê³µë¶€**

## Direct Mapped Cache for Real World
---
![alt text](../assets/img/Architecture/dmcrw.png)

ğŸ“**ì£¼ì†Œ êµ¬ì¡°**(32-bit):  
* **Tag** (20bits): ë°ì´í„°ë¥¼ ì‹ë³„í•˜ëŠ” ê³ ìœ  ë²ˆí˜¸
* **Index** (10bits): ìºì‹œ ë¸”ë¡ì„ ì„ íƒí•˜ëŠ” ë²ˆí˜¸
* **Byte Offset** (2bits): ë¸”ë¡ ë‚´ì—ì„œ íŠ¹ì • ë°”ì´íŠ¸ë¥¼ ì„ íƒ

ğŸ’¾**Cache êµ¬ì¡°**:  
* **ìºì‹œ í¬ê¸°**: 2Â¹â° = 1024ê°œ ë¸”ë¡
* **ë¸”ë¡ í¬ê¸°**: 2Â² = 4ë°”ì´íŠ¸
* **ì „ì²´ ìºì‹œ ìš©ëŸ‰**: 1024 Ã— 4 = `4KB`

âœ…**ìºì‹œ ì ‘ê·¼ ê³¼ì •**  
1. **Index ì¶”ì¶œ** - ì£¼ì†Œì˜ 11-2ë²ˆì§¸ ë¹„íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ìºì‹œ ë¸”ë¡ì„ ì„ íƒ
2. **Tag ë¹„êµ** - ì£¼ì†Œì˜ 31-12ë²ˆì§¸ ë¹„íŠ¸ì™€ í•´ë‹¹ ìºì‹œ ë¸”ë¡ì˜ Tagë¥¼ ë¹„êµ
3. **Hit/Miss íŒë‹¨**
   * **Hit**: **Tagê°€ ì¼ì¹˜**í•˜ê³  `Valid=1`ì´ë©´ ìºì‹œì—ì„œ ë°ì´í„° ë°˜í™˜
   * **Miss**: **Tagê°€ ë‹¤ë¥´ê±°ë‚˜** `Valid=0`ì´ë©´ ë©”ëª¨ë¦¬ì—ì„œ ë°ì´í„° ê°€ì ¸ì™€ì„œ ìºì‹œ ì—…ë°ì´íŠ¸
4. **Byte ì„ íƒ**: `Offset`(1-0ë²ˆì§¸ ë¹„íŠ¸)ì„ ì‚¬ìš©í•˜ì—¬ **4ë°”ì´íŠ¸ ë¸”ë¡ ë‚´**ì—ì„œ íŠ¹ì • ë°”ì´íŠ¸ ì„ íƒ

* **Spatial Locality (ê³µê°„ ì§€ì—­ì„±)**: **ìºì‹œê°€ í•œ ë²ˆì— 4ë°”ì´íŠ¸ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì´ìœ **, í”„ë¡œê·¸ë¨ì´ íŠ¹ì • ë©”ëª¨ë¦¬ ìœ„ì¹˜ì— ì ‘ê·¼í•˜ë©´, ê·¸ ê·¼ì²˜ì˜ ë°ì´í„°ì—ë„ ê³§ ì ‘ê·¼í•  ê°€ëŠ¥ì„±ì´ ë†’ìŒ!

## GENERALIZATION Of Direct Mapped Cache
---
Direct Mapped Cacheì˜ ì¼ë°˜í™” ë²„ì „ ì¡´ì¬

ì´ì „ ì˜ˆì œëŠ” ì •ëœ ê°’ë“¤(1024ë¸”ë¡, 4ë°”ì´íŠ¸)ì„ ì‚¬ìš©í–ˆë‹¤ë©´, ì¼ë°˜í™”ëœ ë²„ì „ì€ ë§¤ê°œë³€ìˆ˜ `n, m`ì„ ì‚¬ìš©í•˜ì—¬ **ë‹¤ì–‘í•œ ìºì‹œ í¬ê¸°ì™€ ë¸”ë¡ í¬ê¸°ë¥¼ ì§€ì›**

* `n`: **ìºì‹œ ë¸”ë¡ ìˆ˜**ë¥¼ ê²°ì • (2â¿ blocks)
* `m`: **block size**ë¥¼ ê²°ì • (2áµ words = 2áµâºÂ² bytes)

1. **Byte Offset í™•ì¥**
* ì´ì „: ê³ ì • 2ë¹„íŠ¸ (4bytes block)
* **ì¼ë°˜í™”**: `m+2` bits (2áµâºÂ² bytes block)

2. **ì›Œë“œ ë‹¨ìœ„ ì²˜ë¦¬**
* 1 ì›Œë“œ = 4ë°”ì´íŠ¸ (32ë¹„íŠ¸ ì‹œìŠ¤í…œ)
* ë¸”ë¡ í¬ê¸°: `2áµ words` = `2áµâºÂ² bytes` = `2áµâºâµ bits`
* **m bits**: ì›Œë“œ ë‚´ì—ì„œ ì„ íƒ
* **2 bits**: ì›Œë“œ ë‚´ì—ì„œ **ë°”ì´íŠ¸ ì„ íƒ**

3. **Tag í¬ê¸° ê³„ì‚°**

```
Tag í¬ê¸° = 32 - Index í¬ê¸° - Offset í¬ê¸°
        = 32 - (n - m + 2)
```

ğŸ“**ì´ Cache memory**: 2â¿ Ã— [2áµâºâµ + (32-n-m-2) + 1] bits

## Bits in Cache
---
ìºì‹œ ì„¤ê³„ ì‹œ ì‹¤ì œ í•„ìš”í•œ **í•˜ë“œì›¨ì–´ ë©”ëª¨ë¦¬ ìš©ëŸ‰ì„ ì •í™•íˆ ê³„ì‚°**í•´ì•¼ ë¹„ìš©ê³¼ ì„±ëŠ¥ì„ ìµœì í™”í•  ìˆ˜ ìˆë‹¤.
* Tagì™€ Valid ë¹„íŠ¸ê¹Œì§€ í¬í•¨í•œ **ì´ ë¹„íŠ¸ ìˆ˜ë¥¼ ê³„ì‚°**

### ì˜ˆì œ ë¬¸ì œ 1
---
Direct Mapped Cache ì¡°ê±´:
* ë°ì´í„° ìš©ëŸ‰: 16 KiB
* ë¸”ë¡ í¬ê¸°: 4 ì›Œë“œ (16 ë°”ì´íŠ¸)
* ì£¼ì†Œ: 32ë¹„íŠ¸

**ì „ì²´ ìºì‹œì— í•„ìš”í•œ ì´ ë¹„íŠ¸ ìˆ˜ëŠ”?**

1. **ì´ ë¸”ë¡ ìˆ˜ ê³„ì‚°**
* **ì „ì²´ ë°ì´í„° í¬ê¸°**: 16 KiB = 2Â¹â´ bytes = `2Â¹Â² words`
* **ê° ë¸”ë¡ í¬ê¸°**: 4 words = `2Â² words`
* **ì´ ë¸”ë¡ ìˆ˜**: 2Â¹Â² Ã· 2Â² = 2Â¹â° = `1024 blocks`
* **Index ë¹„íŠ¸**: logâ‚‚(1024) = 10 bits

2. **Byte Offset ë¹„íŠ¸ ê³„ì‚°**
* **ë¸”ë¡ í¬ê¸°**: 4 words = 16 bytes = 2â´ bytes
* `Byte Offset`: logâ‚‚(16) = `4 bits`

3. **Tag bit ê³„ì‚°**
* **Tag = ì „ì²´ ì£¼ì†Œ - Index - Offset**
* 32 - 10 - 4 = `18 bits`

4. **ê° ë¸”ë¡ë‹¹ í•„ìš”í•œ ë¹„íŠ¸**
* **ë°ì´í„°**: 4 words Ã— 32bits = 128 bits
* **Tag**: `18 bits`
* **Valid**: 1 bits
* **ë¸”ë¡ë‹¹ ì´í•©**: 128 + 18 + 1 = 147 bits

â†’ **cache size**: 1024 x (4 words + 18 bits + 1 bit)   
            = 1024 x (27bits + 18 bits + 1 bit) = 2^10x 147 = `147Kbits`


ë§Œì•½ Cache block size = 512bits ë¡œ ë” í° ë¸”ë¡ì´ë¼ë©´??
![alt text](../assets/img/Architecture/exbic.png)

* **ë¸”ë¡ í¬ê¸°**: 512 bits = 64 bytes = 16 words
* **ì´ ë¸”ë¡ ìˆ˜**: 256ê°œ
* **ì£¼ì†Œ**: 32bits

1. **ì£¼ì†Œ ë¶„í•  ê³„ì‚°**
* **ë¸”ë¡ ìˆ˜**: 256 = 2â¸ â†’ Index = `8 bits`
* **ë¸”ë¡ í¬ê¸°**: 64 ë°”ì´íŠ¸ = 2â¶ â†’ Byte Offset = `6 bits`
* **Tag**: 32 - 8 - 6 = `18 bits`

* í° ë¸”ë¡ì—ì„œëŠ” ì›Œë“œ ë‹¨ìœ„ ì ‘ê·¼ì„ ìœ„í•´ **Offsetì„ ë‘ ë¶€ë¶„ìœ¼ë¡œ ë‚˜ëˆ”!**
  * `Block Offset` (ìƒìœ„ ë¹„íŠ¸): ë¸”ë¡ ë‚´ ì›Œë“œ ì„ íƒ
  * `Byte Offset` (í•˜ìœ„ 2ë¹„íŠ¸): ì›Œë“œ ë‚´ ë°”ì´íŠ¸ ì„ íƒ